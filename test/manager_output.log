Reading in anndata from zarr format: /allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/QCed_gex_byNeigh_final_cleaned/marmoset_TH-EPI-Glut.zarr
Finished reading in anndata: AnnData object with n_obs × n_vars = 79129 × 15138
    obs: 'n_genes_by_counts', 'total_counts', 'pct_counts_mt', 'doublet_score', 'ctm_class', 'ctm_class_prob', 'ctm_subclass', 'ctm_subclass_prob', 'ctm_cl', 'ctm_cl_prob', 'tso_reads_fraction', 'reads_exonic_intronic_fraction', 'concensus_subclass', 'concensus_class', 'neighborhood', 'sample', 'roi', 'donor', 'sex', 'age', 'brain region', 'chemistry', 'species', 'study', 'RF_neighborhood', 'RF_neighborhood_prob', 'RF_class', 'RF_class_prob', 'RF_subclass', 'RF_subclass_prob'
Raw count data provided
Normlazing total counts to 1e6...
Finished normalization. max:12.314486430328666
Memory usage with adata in memory: 3.6%
Finished reading in latent space: (79129, 32)
Manager finished clustering 79129 cells into 25 clusters of sizes [2579, 1280, 1249, 6790, 219, 8593, 2480, 2778, 4268, 4952, 796, 7928, 2224, 1643, 4418, 2047, 4758, 4079, 1298, 1286, 2146, 628, 1123, 6952, 2615]
Initiate 4 activate workers
Worker 3 finished clustering 1249 cells into 9 clusters of sizes [124, 104, 97, 345, 99, 117, 248, 81, 34]
Worker 2 finished clustering 1280 cells into 11 clusters of sizes [302, 240, 51, 89, 112, 49, 36, 86, 188, 61, 66]
Worker 3 finished clustering 219 cells into 4 clusters of sizes [39, 36, 112, 32]
Worker 1 finished clustering 2579 cells into 9 clusters of sizes [542, 306, 180, 205, 156, 157, 91, 805, 137]
Worker 4 finished clustering 6790 cells into 7 clusters of sizes [3980, 1095, 166, 720, 459, 315, 55]
Worker 3 finished clustering 2480 cells into 7 clusters of sizes [136, 587, 135, 668, 185, 719, 50]
Worker 4 finished clustering 4268 cells into 4 clusters of sizes [3060, 662, 136, 410]
Worker 1 finished clustering 2778 cells into 13 clusters of sizes [174, 162, 391, 422, 154, 153, 207, 163, 263, 76, 181, 291, 141]
Worker 2 finished clustering 8593 cells into 1 clusters of sizes [8593]
Worker 4 finished clustering 796 cells into 5 clusters of sizes [140, 119, 450, 23, 64]
Worker 3 finished clustering 4952 cells into 6 clusters of sizes [3149, 434, 344, 499, 445, 81]
Worker 4 finished clustering 1643 cells into 2 clusters of sizes [908, 735]
Worker 2 finished clustering 2224 cells into 8 clusters of sizes [100, 442, 295, 204, 196, 228, 40, 719]
Worker 3 finished clustering 4418 cells into 2 clusters of sizes [3552, 866]
Worker 4 finished clustering 2047 cells into 1 clusters of sizes [2047]
Worker 1 finished clustering 7928 cells into 1 clusters of sizes [7928]
Worker 4 finished clustering 1298 cells into 4 clusters of sizes [1087, 90, 72, 49]
Worker 2 finished clustering 4758 cells into 2 clusters of sizes [4403, 355]
Worker 1 finished clustering 1286 cells into 3 clusters of sizes [526, 727, 33]
Worker 3 finished clustering 4079 cells into 5 clusters of sizes [169, 2293, 614, 395, 608]
Worker 2 finished clustering 628 cells into 2 clusters of sizes [480, 148]
Worker 4 finished clustering 2146 cells into 2 clusters of sizes [1875, 271]
Worker 1 finished clustering 1123 cells into 4 clusters of sizes [157, 129, 684, 153]
Worker 4 finished clustering 124 cells into 1 clusters of sizes [124]
Worker 1 finished clustering 104 cells into 1 clusters of sizes [104]
Worker 4 finished clustering 97 cells into 2 clusters of sizes [63, 34]
Worker 4 finished clustering 99 cells into 1 clusters of sizes [99]
Worker 4 finished clustering 117 cells into 2 clusters of sizes [50, 67]
Worker 1 finished clustering 345 cells into 2 clusters of sizes [81, 264]
Worker 2 finished clustering 2615 cells into 2 clusters of sizes [136, 2479]
Worker 1 finished clustering 81 cells into 1 clusters of sizes [81]
Worker 2 finished clustering 34 cells into 1 clusters of sizes [34]
Worker 4 finished clustering 248 cells into 3 clusters of sizes [68, 128, 52]
Worker 4 finished clustering 51 cells into 1 clusters of sizes [51]
Worker 1 finished clustering 302 cells into 2 clusters of sizes [35, 267]
Worker 2 finished clustering 240 cells into 2 clusters of sizes [172, 68]
Worker 4 finished clustering 89 cells into 1 clusters of sizes [89]
Worker 1 finished clustering 112 cells into 1 clusters of sizes [112]
Worker 2 finished clustering 49 cells into 1 clusters of sizes [49]
Worker 4 finished clustering 36 cells into 1 clusters of sizes [36]
Worker 3 finished clustering 6952 cells into 5 clusters of sizes [5269, 444, 401, 671, 167]
Worker 1 finished clustering 86 cells into 1 clusters of sizes [86]
Worker 4 finished clustering 61 cells into 2 clusters of sizes [31, 30]
Worker 2 finished clustering 188 cells into 1 clusters of sizes [188]
Worker 3 finished clustering 66 cells into 1 clusters of sizes [66]
Worker 1 finished clustering 39 cells into 1 clusters of sizes [39]
Worker 4 finished clustering 36 cells into 1 clusters of sizes [36]
Worker 3 finished clustering 32 cells into 1 clusters of sizes [32]
Worker 2 finished clustering 112 cells into 1 clusters of sizes [112]
Worker 3 finished clustering 180 cells into 1 clusters of sizes [180]
Worker 4 finished clustering 306 cells into 1 clusters of sizes [306]
Worker 2 finished clustering 205 cells into 2 clusters of sizes [47, 158]
Worker 1 finished clustering 542 cells into 2 clusters of sizes [355, 187]
Worker 4 finished clustering 157 cells into 1 clusters of sizes [157]
Worker 3 finished clustering 156 cells into 1 clusters of sizes [156]
Worker 2 finished clustering 91 cells into 1 clusters of sizes [91]
Worker 4 finished clustering 137 cells into 1 clusters of sizes [137]
Worker 4 finished clustering 166 cells into 1 clusters of sizes [166]
Worker 1 finished clustering 805 cells into 2 clusters of sizes [742, 63]
Worker 2 finished clustering 1095 cells into 1 clusters of sizes [1095]
Worker 4 finished clustering 720 cells into 1 clusters of sizes [720]
Worker 1 finished clustering 459 cells into 2 clusters of sizes [297, 162]
Worker 4 finished clustering 55 cells into 1 clusters of sizes [55]
Worker 3 finished clustering 3980 cells into 3 clusters of sizes [3692, 151, 137]
Worker 2 finished clustering 315 cells into 1 clusters of sizes [315]
Worker 1 finished clustering 136 cells into 2 clusters of sizes [62, 74]
Worker 3 finished clustering 135 cells into 1 clusters of sizes [135]
Worker 2 finished clustering 668 cells into 2 clusters of sizes [558, 110]
Worker 4 finished clustering 587 cells into 2 clusters of sizes [533, 54]
Worker 2 finished clustering 50 cells into 1 clusters of sizes [50]
Worker 1 finished clustering 185 cells into 2 clusters of sizes [87, 98]
Worker 3 finished clustering 719 cells into 1 clusters of sizes [719]
Worker 1 finished clustering 136 cells into 1 clusters of sizes [136]
Worker 2 finished clustering 662 cells into 2 clusters of sizes [132, 530]
Worker 1 finished clustering 174 cells into 2 clusters of sizes [77, 97]
Worker 3 finished clustering 410 cells into 1 clusters of sizes [410]
Worker 2 finished clustering 162 cells into 1 clusters of sizes [162]
Worker 4 finished clustering 3060 cells into 2 clusters of sizes [2973, 87]
Worker 4 finished clustering 153 cells into 1 clusters of sizes [153]
Worker 1 finished clustering 391 cells into 2 clusters of sizes [138, 253]
Worker 3 finished clustering 422 cells into 2 clusters of sizes [324, 98]
Worker 2 finished clustering 154 cells into 1 clusters of sizes [154]
Worker 1 finished clustering 163 cells into 2 clusters of sizes [72, 91]
Worker 4 finished clustering 207 cells into 1 clusters of sizes [207]
Worker 2 finished clustering 76 cells into 2 clusters of sizes [52, 24]
Worker 3 finished clustering 263 cells into 1 clusters of sizes [263]
Worker 1 finished clustering 181 cells into 2 clusters of sizes [143, 38]
Worker 2 finished clustering 141 cells into 2 clusters of sizes [40, 101]
Worker 4 finished clustering 291 cells into 1 clusters of sizes [291]
Worker 1 finished clustering 119 cells into 1 clusters of sizes [119]
Worker 3 finished clustering 140 cells into 2 clusters of sizes [35, 105]
Worker 4 finished clustering 23 cells into 1 clusters of sizes [23]
Worker 1 finished clustering 64 cells into 1 clusters of sizes [64]
Worker 2 finished clustering 450 cells into 3 clusters of sizes [382, 39, 29]
Worker 1 finished clustering 344 cells into 1 clusters of sizes [344]
Worker 4 finished clustering 434 cells into 1 clusters of sizes [434]
Worker 4 finished clustering 81 cells into 1 clusters of sizes [81]
Worker 2 finished clustering 499 cells into 1 clusters of sizes [499]
Worker 1 finished clustering 445 cells into 1 clusters of sizes [445]
Worker 3 finished clustering 3149 cells into 3 clusters of sizes [1428, 353, 1368]
Worker 1 finished clustering 100 cells into 1 clusters of sizes [100]
Worker 2 finished clustering 735 cells into 2 clusters of sizes [463, 272]
Worker 4 finished clustering 908 cells into 2 clusters of sizes [264, 644]
Worker 3 finished clustering 442 cells into 1 clusters of sizes [442]
Worker 4 finished clustering 196 cells into 1 clusters of sizes [196]
Worker 1 finished clustering 295 cells into 1 clusters of sizes [295]
Worker 3 finished clustering 228 cells into 1 clusters of sizes [228]
Worker 2 finished clustering 204 cells into 1 clusters of sizes [204]
Worker 4 finished clustering 40 cells into 1 clusters of sizes [40]
Worker 1 finished clustering 719 cells into 2 clusters of sizes [354, 365]
Worker 1 finished clustering 90 cells into 1 clusters of sizes [90]
Worker 2 finished clustering 866 cells into 1 clusters of sizes [866]
Worker 4 finished clustering 1087 cells into 1 clusters of sizes [1087]
Worker 1 finished clustering 72 cells into 1 clusters of sizes [72]
Worker 2 finished clustering 49 cells into 1 clusters of sizes [49]
Worker 3 finished clustering 3552 cells into 2 clusters of sizes [1255, 2297]
Worker 1 finished clustering 355 cells into 1 clusters of sizes [355]
Worker 1 finished clustering 33 cells into 1 clusters of sizes [33]
Worker 2 finished clustering 526 cells into 1 clusters of sizes [526]
Worker 1 finished clustering 169 cells into 1 clusters of sizes [169]
Worker 3 finished clustering 727 cells into 1 clusters of sizes [727]
Worker 3 finished clustering 395 cells into 2 clusters of sizes [325, 70]
Worker 1 finished clustering 614 cells into 1 clusters of sizes [614]
Worker 4 finished clustering 4403 cells into 1 clusters of sizes [4403]
Worker 2 finished clustering 2293 cells into 2 clusters of sizes [2152, 141]
Worker 4 finished clustering 148 cells into 1 clusters of sizes [148]
Worker 1 finished clustering 480 cells into 1 clusters of sizes [480]
Worker 3 finished clustering 608 cells into 2 clusters of sizes [279, 329]
Worker 4 finished clustering 271 cells into 1 clusters of sizes [271]
Worker 1 finished clustering 157 cells into 1 clusters of sizes [157]
Worker 3 finished clustering 129 cells into 1 clusters of sizes [129]
Worker 2 finished clustering 1875 cells into 1 clusters of sizes [1875]
Worker 3 finished clustering 63 cells into 1 clusters of sizes [63]
Worker 2 finished clustering 34 cells into 1 clusters of sizes [34]
Worker 1 finished clustering 153 cells into 1 clusters of sizes [153]
Worker 3 finished clustering 50 cells into 1 clusters of sizes [50]
Worker 2 finished clustering 67 cells into 1 clusters of sizes [67]
Worker 1 finished clustering 81 cells into 1 clusters of sizes [81]
Worker 4 finished clustering 684 cells into 1 clusters of sizes [684]
Worker 3 finished clustering 264 cells into 2 clusters of sizes [109, 155]
Worker 4 finished clustering 68 cells into 1 clusters of sizes [68]
Worker 2 finished clustering 136 cells into 1 clusters of sizes [136]
Worker 2 finished clustering 35 cells into 1 clusters of sizes [35]
Worker 4 finished clustering 52 cells into 1 clusters of sizes [52]
Worker 3 finished clustering 128 cells into 1 clusters of sizes [128]
Worker 4 finished clustering 172 cells into 1 clusters of sizes [172]
Worker 2 finished clustering 267 cells into 1 clusters of sizes [267]
Worker 3 finished clustering 68 cells into 1 clusters of sizes [68]
Worker 3 finished clustering 401 cells into 1 clusters of sizes [401]
Worker 1 finished clustering 2479 cells into 1 clusters of sizes [2479]
Worker 2 finished clustering 444 cells into 1 clusters of sizes [444]
Worker 2 finished clustering 31 cells into 1 clusters of sizes [31]
Worker 3 finished clustering 671 cells into 1 clusters of sizes [671]
Worker 2 finished clustering 30 cells into 1 clusters of sizes [30]
Worker 1 finished clustering 167 cells into 1 clusters of sizes [167]
Worker 3 finished clustering 47 cells into 1 clusters of sizes [47]
Worker 2 finished clustering 158 cells into 1 clusters of sizes [158]
Worker 3 finished clustering 187 cells into 1 clusters of sizes [187]
Worker 4 finished clustering 5269 cells into 3 clusters of sizes [4430, 382, 457]
Worker 1 finished clustering 355 cells into 1 clusters of sizes [355]
Worker 3 finished clustering 63 cells into 1 clusters of sizes [63]
Worker 4 finished clustering 297 cells into 1 clusters of sizes [297]
Worker 1 finished clustering 162 cells into 1 clusters of sizes [162]
Worker 2 finished clustering 742 cells into 3 clusters of sizes [561, 109, 72]
Worker 4 finished clustering 151 cells into 1 clusters of sizes [151]
Worker 2 finished clustering 62 cells into 1 clusters of sizes [62]
Worker 1 finished clustering 137 cells into 1 clusters of sizes [137]
Worker 4 finished clustering 74 cells into 1 clusters of sizes [74]
Worker 1 finished clustering 110 cells into 1 clusters of sizes [110]
Worker 2 finished clustering 558 cells into 1 clusters of sizes [558]
Worker 1 finished clustering 54 cells into 1 clusters of sizes [54]
Worker 3 finished clustering 3692 cells into 1 clusters of sizes [3692]
Worker 2 finished clustering 87 cells into 1 clusters of sizes [87]
Worker 4 finished clustering 533 cells into 1 clusters of sizes [533]
Worker 1 finished clustering 98 cells into 1 clusters of sizes [98]
Worker 3 finished clustering 132 cells into 1 clusters of sizes [132]
Worker 4 finished clustering 77 cells into 1 clusters of sizes [77]
Worker 2 finished clustering 530 cells into 1 clusters of sizes [530]
Worker 1 finished clustering 97 cells into 1 clusters of sizes [97]
Worker 4 finished clustering 87 cells into 2 clusters of sizes [54, 33]
Worker 2 finished clustering 138 cells into 1 clusters of sizes [138]
Worker 2 finished clustering 98 cells into 1 clusters of sizes [98]
Worker 1 finished clustering 253 cells into 1 clusters of sizes [253]
Worker 4 finished clustering 324 cells into 1 clusters of sizes [324]
Worker 4 finished clustering 52 cells into 1 clusters of sizes [52]
Worker 2 finished clustering 72 cells into 1 clusters of sizes [72]
Worker 1 finished clustering 91 cells into 1 clusters of sizes [91]
Worker 4 finished clustering 24 cells into 1 clusters of sizes [24]
Worker 1 finished clustering 38 cells into 1 clusters of sizes [38]
Worker 4 finished clustering 40 cells into 1 clusters of sizes [40]
Worker 2 finished clustering 143 cells into 1 clusters of sizes [143]
Worker 4 finished clustering 35 cells into 1 clusters of sizes [35]
Worker 1 finished clustering 101 cells into 1 clusters of sizes [101]
Worker 3 finished clustering 2973 cells into 1 clusters of sizes [2973]
Worker 2 finished clustering 105 cells into 1 clusters of sizes [105]
Worker 1 finished clustering 39 cells into 1 clusters of sizes [39]
Worker 3 finished clustering 29 cells into 1 clusters of sizes [29]
Worker 4 finished clustering 382 cells into 1 clusters of sizes [382]
Worker 1 finished clustering 353 cells into 1 clusters of sizes [353]
Worker 4 finished clustering 463 cells into 1 clusters of sizes [463]
Worker 3 finished clustering 1368 cells into 1 clusters of sizes [1368]
Worker 1 finished clustering 272 cells into 1 clusters of sizes [272]
Worker 2 finished clustering 1428 cells into 1 clusters of sizes [1428]
Worker 4 finished clustering 264 cells into 1 clusters of sizes [264]
Worker 1 finished clustering 354 cells into 1 clusters of sizes [354]
Worker 3 finished clustering 644 cells into 1 clusters of sizes [644]
Worker 2 finished clustering 365 cells into 1 clusters of sizes [365]
Worker 2 finished clustering 70 cells into 1 clusters of sizes [70]
Worker 3 finished clustering 325 cells into 1 clusters of sizes [325]
Worker 4 finished clustering 1255 cells into 3 clusters of sizes [57, 1063, 135]
Worker 1 finished clustering 2297 cells into 1 clusters of sizes [2297]
Worker 3 finished clustering 141 cells into 1 clusters of sizes [141]
Worker 4 finished clustering 279 cells into 1 clusters of sizes [279]
Worker 3 finished clustering 109 cells into 1 clusters of sizes [109]
Worker 1 finished clustering 329 cells into 1 clusters of sizes [329]
Worker 4 finished clustering 155 cells into 1 clusters of sizes [155]
Worker 2 finished clustering 2152 cells into 1 clusters of sizes [2152]
Worker 1 finished clustering 382 cells into 1 clusters of sizes [382]
Worker 4 finished clustering 457 cells into 1 clusters of sizes [457]
Worker 1 finished clustering 109 cells into 1 clusters of sizes [109]
Worker 4 finished clustering 72 cells into 1 clusters of sizes [72]
Worker 1 finished clustering 54 cells into 1 clusters of sizes [54]
Worker 2 finished clustering 561 cells into 1 clusters of sizes [561]
Worker 4 finished clustering 33 cells into 1 clusters of sizes [33]
Worker 1 finished clustering 57 cells into 1 clusters of sizes [57]
Manger node sent None to worker node 1. Currently 3 active workers
Worker 4 finished clustering 135 cells into 1 clusters of sizes [135]
Manger node sent None to worker node 4. Currently 2 active workers
Worker 3 finished clustering 4430 cells into 1 clusters of sizes [4430]
Manger node sent None to worker node 3. Currently 1 active workers
Worker 2 finished clustering 1063 cells into 1 clusters of sizes [1063]
Manger node sent None to worker node 2. Currently 0 active workers
Finished all clustering tasks in 569.7785 seconds
Total number of clusters: 166
Finished writing clustering results to /allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/hicatMPI_v2/test/out
Next step: run a final merge of clusters
