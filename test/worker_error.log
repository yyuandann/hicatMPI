2026-02-25 06:46:23,173 matplotlib   DEBUG    matplotlib data path: /allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/matplotlib/mpl-data
2026-02-25 06:46:23,274 matplotlib   DEBUG    CONFIGDIR=/home/dan.yuan/.config/matplotlib
2026-02-25 06:46:23,278 matplotlib   DEBUG    interactive is False
2026-02-25 06:46:23,278 matplotlib   DEBUG    platform is linux
2026-02-25 06:46:23,346 matplotlib   DEBUG    CACHEDIR=/home/dan.yuan/.cache/matplotlib
2026-02-25 06:46:23,350 matplotlib.font_manager DEBUG    Using fontManager instance from /home/dan.yuan/.cache/matplotlib/fontlist-v390.json
2026-02-25 06:46:31,150 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:46:31,150 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:46:31,152 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.001874685287475586
2026-02-25 06:46:31,152 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/6790 [00:00<?, ?it/s] 23%|██▎       | 1593/6790 [00:00<00:00, 15468.21it/s]100%|██████████| 6790/6790 [00:00<00:00, 40836.78it/s]
  0%|          | 0/6790 [00:00<?, ?it/s] 27%|██▋       | 1809/6790 [00:00<00:00, 17334.76it/s] 73%|███████▎  | 4973/6790 [00:00<00:00, 25518.18it/s]100%|██████████| 6790/6790 [00:00<00:00, 27318.85it/s]
2026-02-25 06:46:38,314 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 15 clusters
2026-02-25 06:46:38,314 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 7.161914948374033
2026-02-25 06:46:38,314 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:46:38,314 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:46:38,319 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:46:38,319 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0046411678194999695
2026-02-25 06:46:38,319 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:46:38,319 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:46:38,319 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.68654727935791e-05
2026-02-25 06:46:38,319 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:46:40,081 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:46:40,082 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 1.7621893137693405
2026-02-25 06:46:40,082 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:46:40,082 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:46:40,102 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:46:40,103 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:46:40,103 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:46:40,105 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:46:40,106 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:46:40,107 transcriptomic_clustering.de_ebayes INFO     Comparing 37 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:46:43,337 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:46:43,338 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:46:43,338 transcriptomic_clustering.merging DEBUG    Merging cluster 10 into 8 -- de score: 0
2026-02-25 06:46:43,344 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 0 -- de score: 0
2026-02-25 06:46:43,352 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 1 -- de score: 0
2026-02-25 06:46:43,359 transcriptomic_clustering.merging DEBUG    Merging cluster 14 into 12 -- de score: 64.50403496179554
2026-02-25 06:46:43,365 transcriptomic_clustering.merging DEBUG    Merging cluster 13 into 9 -- de score: 121.00895795632667
2026-02-25 06:46:43,371 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:46:43,379 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:46:43,379 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:46:43,379 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:46:43,381 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:46:43,381 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:46:43,382 transcriptomic_clustering.de_ebayes INFO     Comparing 15 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:46:44,761 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:46:44,761 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:46:44,762 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:46:44,768 transcriptomic_clustering.merging DEBUG    Merging cluster 12 into 9 -- de score: 0
2026-02-25 06:46:44,775 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:46:44,782 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:46:44,782 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:46:44,782 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:46:44,784 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:46:44,784 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:46:44,785 transcriptomic_clustering.de_ebayes INFO     Comparing 7 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:46:45,507 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:46:45,507 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:46:45,507 transcriptomic_clustering.merging DEBUG    Merging cluster 9 into 0 -- de score: 0
2026-02-25 06:46:45,514 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:46:45,519 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:46:45,519 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:46:45,519 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:46:45,521 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:46:45,521 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:46:45,523 transcriptomic_clustering.de_ebayes INFO     Comparing 4 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:46:45,905 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:46:45,905 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:46:45,906 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 5.823809217661619
2026-02-25 06:46:45,906 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:46:45,906 transcriptomic_clustering.markers DEBUG    Generating markers for 21.0 pairs of clusters
2026-02-25 06:46:45,906 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:46:45,907 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:46:45,908 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:46:45,909 transcriptomic_clustering.de_ebayes INFO     Comparing 21 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:46:47,991 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:46:47,991 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 2.085165984928608
2026-02-25 06:46:47,991 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:46:47,991 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 9.67682833597064
2026-02-25 06:46:47,991 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:46:53,318 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:46:53,318 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:46:53,319 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.000853121280670166
2026-02-25 06:46:53,319 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/4268 [00:00<?, ?it/s]100%|██████████| 4268/4268 [00:00<00:00, 47720.23it/s]
  0%|          | 0/4268 [00:00<?, ?it/s] 47%|████▋     | 1989/4268 [00:00<00:00, 18795.78it/s]100%|██████████| 4268/4268 [00:00<00:00, 24352.05it/s]
2026-02-25 06:46:57,794 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 12 clusters
2026-02-25 06:46:57,794 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 4.474876552820206
2026-02-25 06:46:57,794 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:46:57,794 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:46:57,798 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:46:57,798 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.003761712461709976
2026-02-25 06:46:57,798 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:46:57,798 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:46:57,798 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.533810377120972e-05
2026-02-25 06:46:57,798 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:46:58,691 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:46:58,691 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.89258973300457
2026-02-25 06:46:58,691 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:46:58,691 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:46:58,704 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:46:58,704 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:46:58,704 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:46:58,706 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:46:58,707 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:46:58,708 transcriptomic_clustering.de_ebayes INFO     Comparing 32 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **a3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:46:41,964 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:46:41,964 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 5.572316162288189
2026-02-25 06:46:41,964 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:46:41,964 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 10.220958519726992
2026-02-25 06:46:41,964 transcriptomic_clust/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureW2026-02-25 06:47:04,654 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:47:04,654 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 2.3910081572830677
2026-02-25 06:47:04,654 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:47:04,655 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:04,669 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:04,669 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:04,669 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:04,672 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:04,672 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:04,673 transcriptomic_clustering.de_ebayes INFO     Comparing 35 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:47:07,971 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:47:07,972 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:47:07,972 transcriptomic_clustering.merging DEBUG    Merging cluster 12 into 6 -- de score: 0
2026-02-25 06:47:07,981 transcriptomic_clustering.merging DEBUG    Merging cluster 11 into 3 -- de score: 0
2026-02-25 06:47:07,988 transcriptomic_clustering.merging DEBUG    Merging cluster 10 into 4 -- de score: 0
2026-02-25 06:47:07,995 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 1 -- de score: 0
2026-02-25 06:47:08,001 transcriptomic_clustering.merging DEBUG    Merging cluster 8 into 7 -- de score: 90.84593866747929
2026-02-25 06:47:08,007 transcriptomic_clustering.merging DEBUG    Merging cluster 9 into 2 -- de score: 169.1800340253643
2026-02-25 06:47:08,013 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:08,020 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:08,020 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:08,020 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:08,022 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:08,022 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:08,024 transcriptomic_clustering.de_ebayes INFO     Comparing 14 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:47:09,272 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:47:09,272 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:47:09,273 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 4 -- de score: 0
2026-02-25 06:47:09,279 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 0
2026-02-25 06:47:09,286 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 3 -- de score: 0
2026-02-25 06:47:09,292 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:09,292 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:47:09,298 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:09,298 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:09,298 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:09,300 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:09,300 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:09,301 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:47:09,873 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:47:09,873 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:47:09,874 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 0
2026-02-25 06:47:09,880 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 448.6631108791512
2026-02-25 06:47:09,885 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:09,885 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:47:09,889 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:09,889 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:09,889 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:09,891 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:09,891 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:09,892 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:47:10,039 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:47:10,039 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:47:10,040 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:47:10,046 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:47:10,046 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 5.391458537429571
2026-02-25 06:47:10,046 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:47:10,046 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:47:10,046 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:10,048 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:10,048 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:10,050 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:47:10,439 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:47:10,439 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.3931345082819462
2026-02-25 06:47:10,439 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:47:10,440 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 8.182108502835035
2026-02-25 06:47:10,440 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:47:11,166 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:47:11,166 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:47:11,167 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0010230913758277893
2026-02-25 06:47:11,167 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/2224 [00:00<?, ?it/s]100%|██████████| 2224/2224 [00:00<00:00, 61082.36it/s]
  0%|          | 0/2224 [00:00<?, ?it/s]100%|██████████| 2224/2224 [00:00<00:00, 1510384.08it/s]
2026-02-25 06:47:13,257 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 13 clusters
2026-02-25 06:47:13,257 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 2.089492790400982
2026-02-25 06:47:13,257 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:47:13,257 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:47:13,261 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:47:13,261 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0034785419702529907
2026-02-25 06:47:13,261 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:47:13,261 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:47:13,261 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 4.4539570808410645e-05
2026-02-25 06:47:13,261 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:47:13,730 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:47:13,730 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.4690336398780346
2026-02-25 06:47:13,730 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:47:13,730 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:13,744 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:13,744 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:13,745 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:13,748 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:13,748 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:13,749 transcriptomic_clustering.de_ebayes INFO     Comparing 35 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:47:17,034 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:47:17,035 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:47:17,035 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 4 -- de score: 0
2026-02-25 06:47:17,042 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 1 -- de score: 0
2026-02-25 06:47:17,049 transcriptomic_clustering.merging DEBUG    Merging cluster 8 into 3 -- de score: 48.24646699264195
2026-02-25 06:47:17,055 transcriptomic_clustering.merging DEBUG    Merging cluster 10 into 7 -- de score: 69.88706087025781
2026-02-25 06:47:17,062 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:17,070 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:17,070 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:17,070 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:17,072 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:17,072 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:17,073 transcriptomic_clustering.de_ebayes INFO     Comparing 13 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:47:18,227 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:47:18,228 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:47:18,228 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 1 -- de score: 58.83976069044177
2026-02-25 06:47:18,234 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:18,240 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:18,240 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:18,240 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:18,241 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:18,242 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:18,243 transcriptomic_clustering.de_ebayes INFO     Comparing 4 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:47:18,621 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:47:18,622 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE2026-02-25 06:47:14,667 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 11 clusters
2026-02-25 06:47:14,667 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 1.4292240738868713
2026-02-25 06:47:14,667 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:47:14,667 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:47:14,670 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:47:14,670 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0027112774550914764
2026-02-25 06:47:14,670 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:47:14,670 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:47:14,670 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.986433148384094e-05
2026-02-25 06:47:14,670 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:47:14,958 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:47:14,958 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.28772594779729843
2026-02-25 06:47:14,958 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:47:14,958 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:14,970 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:14,970 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:14,970 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:14,973 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:14,973 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:14,975 transcriptomic_clustering.de_ebayes INFO     Comparing 27 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce ove/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.out, **passkwargs)
2026-02-25 06:47:05,157 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:47:05,158 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 6.8630908243358135
2026-02-25 06:47:05,158 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:47:05,158 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 11.92730950564146
2026-02-25 06:47:05,158 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:47:11,560 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:47:11,560 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:47:11,561 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0009672641754150391
2026-02-25 06:47:11,562 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/7928 [00:00<?, ?it/s] 17%|█▋        | 1329/7928 [00:00<00:00, 9508.14it/s] 93%|█████████▎| 7401/7928 [00:00<00:00, 35385.22it/s]100%|██████████| 7928/7928 [00:00<00:00, 32853.37it/s]
  0%|          | 0/7928 [00:00<?, ?it/s]100%|██████████| 7928/7928 [00:00<00:00, 91142.28it/s]
2026-02-25 06:47:28,965 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 13 clusters
2026-02-25 06:47:28,966 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 17.403986908495426
2026-02-25 06:47:28,966 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:47:28,966 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:47:28,972 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:47:28,972 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.006161373108625412
2026-02-25 06:47:28,972 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:47:28,972 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:47:28,972 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.867223858833313e-05
2026-02-25 06:47:28,972 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:47:31,337 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:47:31,337 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 2.3648889139294624
2026-02-25 06:47:31,337 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:47:31,338 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:31,351 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:31,351 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:31,351 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:31,354 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:31,354 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:31,355 transcriptomic_clustering.de_ebayes INFO     Comparing 36 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:47:34,507 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:47:34,507 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:47:34,508 transcriptomic_clustering.merging DEBUG    Merging cluster 12 into 6 -- de score: 0
2026-02-25 06:47:34,514 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 2 -- de score: 0
2026-02-25 06:47:34,520 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 0 -- de score: 0
2026-02-25 06:47:34,525 transcriptomic_clustering.merging DEBUG    Merging cluster 11 into 10 -- de score: 0
2026-02-25 06:47:34,531 transcriptomic_clustering.merging DEBUG    Merging cluster 9 into 7 -- de score: 0
2026-02-25 06:47:34,537 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 1 -- de score: 0
2026-02-25 06:47:34,544 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:34,551 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:34,551 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:34,551 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:34,553 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:34,553 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:34,554 transcriptomic_clustering.de_ebayes INFO     Comparing 14 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **pas/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:47:35,928 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:47:35,929 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:47:35,929 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 0
2026-02-25 06:47:35,936 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 0 -- de score: 0
2026-02-25 06:47:35,945 transcriptomic_clustering.merging DEBUG    Merging cluster 10 into 8 -- de score: 0
2026-02-25 06:47:35,952 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 0
2026-02-25 06:47:35,959 transcriptomic_clustering.merging DEBUG    Merging cluster 11 into 7 -- de score: 0
2026-02-25 06:47:35,966 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:35,973 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:35,973 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:35,973 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:35,975 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:35,975 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:35,977 transcriptomic_clustering.de_ebayes INFO     Comparing 13 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, 2026-02-25 06:47:38,358 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 10 clusters
2026-02-25 06:47:38,358 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 1.181395098567009
2026-02-25 06:47:38,358 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:47:38,358 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:47:38,361 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:47:38,361 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0024114884436130524
2026-02-25 06:47:38,361 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:47:38,361 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:47:38,361 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.339722752571106e-05
2026-02-25 06:47:38,361 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:47:38,569 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:47:38,569 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.2082386054098606
2026-02-25 06:47:38,569 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:47:38,569 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:38,580 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:38,580 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:38,580 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:38,583 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:38,583 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:38,584 transcriptomic_clustering.de_ebayes INFO     Comparing 23 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnu2026-02-25 06:47:40,743 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 8 clusters
2026-02-25 06:47:40,744 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.8182606361806393
2026-02-25 06:47:40,744 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:47:40,744 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:47:40,746 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:47:40,746 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0022551342844963074
2026-02-25 06:47:40,746 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:47:40,746 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:47:40,746 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 4.1153281927108765e-05
2026-02-25 06:47:40,746 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:47:40,832 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:47:40,832 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.08566302433609962
2026-02-25 06:47:40,832 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:47:40,832 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:40,842 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:40,842 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:40,842 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:40,845 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:40,845 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:40,847 transcriptomic_clustering.de_ebayes INFO     Comparing 19 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:47:42,645 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:47:42,646 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:47:42,646 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 1 -- de score: 0
2026-02-25 06:47:42,653 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:47:42,659 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 3 -- de score: 0
2026-02-25 06:47:42,665 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:42,671 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:42,671 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:42,671 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:42,673 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:42,673 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:42,675 transcriptomic_clustering.de_ebayes INFO     Comparing 9 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:47:43,446 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:47:43,447 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:47:43,447 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:47:43,453 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:43,453 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:47:43,457 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:43,457 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:43,457 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:43,459 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:43,459 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:43,461 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumer2026-02-25 06:47:44,515 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 8 clusters
2026-02-25 06:47:44,515 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.9421055167913437
2026-02-25 06:47:44,515 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:47:44,515 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:47:44,517 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:47:44,517 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.002002168446779251
2026-02-25 06:47:44,517 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:47:44,517 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:47:44,517 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.288686275482178e-05
2026-02-25 06:47:44,517 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:47:44,691 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:47:44,691 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.1738431304693222
2026-02-25 06:47:44,691 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:47:44,691 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:44,700 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:44,700 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:44,700 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:44,703 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:44,703 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:44,704 transcriptomic_clustering.de_ebayes INFO     Comparing 20 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, 2026-02-25 06:47:46,935 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:47:46,935 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:47:46,936 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.001005999743938446
2026-02-25 06:47:46,936 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/2615 [00:00<?, ?it/s]100%|██████████| 2615/2615 [00:00<00:00, 50470.07it/s]
  0%|          | 0/2615 [00:00<?, ?it/s] 90%|████████▉ | 2350/2615 [00:00<00:00, 23427.19it/s]100%|██████████| 2615/2615 [00:00<00:00, 25068.75it/s]
2026-02-25 06:47:50,407 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 13 clusters
2026-02-25 06:47:50,408 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 3.4711673632264137
2026-02-25 06:47:50,408 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:47:50,408 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:47:50,412 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:47:50,412 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.003793131560087204
2026-02-25 06:47:50,412 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:47:50,412 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:47:50,412 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 4.4561922550201416e-05
2026-02-25 06:47:50,412 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:47:51,010 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:47:51,010 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.5981979109346867
2026-02-25 06:47:51,010 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:47:51,010 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:51,026 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:51,026 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:51,026 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:51,029 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:51,029 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:51,030 transcriptomic_clustering.de_ebayes INFO     Comparing 36 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:47:54,569 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:47:54,570 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:47:54,570 transcriptomic_clustering.merging DEBUG    Merging cluster 8 into 5 -- de score: 0
2026-02-25 06:47:54,577 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 2 -- de score: 0
2026-02-25 06:47:54,584 transcriptomic_clustering.merging DEBUG    Merging cluster 12 into 9 -- de score: 0
2026-02-25 06:47:54,590 transcriptomic_clustering.merging DEBUG    Merging cluster 11 into 0 -- de score: 0
2026-02-25 06:47:54,596 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 1 -- de score: 0
2026-02-25 06:47:54,603 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:54,610 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:54,611 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:54,611 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:54,612 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:54,613 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:54,614 transcriptomic_clustering.de_ebayes INFO     Comparing 12 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:47:55,846 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:47:55,846 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:47:55,847 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:47:55,854 transcriptomic_clustering.merging DEBUG    Merging cluster 10 into 9 -- de score: 0
2026-02-25 06:47:55,860 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 2 -- de score: 0
2026-02-25 06:47:55,868 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:47:55,874 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:47:55,874 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:47:55,874 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:47:55,876 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:47:55,876 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:47:55,878 transcriptomic_clustering.de_ebayes INFO     Comparing 9 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the2026-02-25 06:47:58,502 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 12 clusters
2026-02-25 06:47:58,502 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 11.554449781775475
2026-02-25 06:47:58,502 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:47:58,502 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:47:58,508 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:47:58,508 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.005420845001935959
2026-02-25 06:47:58,508 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:47:58,508 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:47:58,508 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 4.087015986442566e-05
2026-02-25 06:47:58,508 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:48:00,721 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:48:00,722 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 2.213241159915924
2026-02-25 06:48:00,722 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:48:00,722 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:00,736 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:00,736 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:00,736 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:00,739 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:00,739 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:00,741 transcriptomic_clustering.de_ebayes INFO     Comparing 30 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:03,687 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:03,688 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:03,688 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 0
2026-02-25 06:48:03,698 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 0 -- de score: 0
2026-02-25 06:48:03,706 transcriptomic_clustering.merging DEBUG    Merging cluster 9 into 5 -- de score: 0
2026-02-25 06:48:03,713 transcriptomic_clustering.merging DEBUG    Merging cluster 11 into 8 -- de score: 170.38161149027462
2026-02-25 06:48:03,719 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:03,726 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:03,726 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:03,726 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:03,728 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:03,728 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:03,729 transcriptomic_clustering.de_ebayes INFO     Comparing 12 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:04,875 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:04,876 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:04,876 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:48:04,882 transcriptomic_clustering.merging DEBUG    Merging cluster 8 into 5 -- de score: 0
2026-02-25 06:48:04,888 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:04,893 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:04,893 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:04,894 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:04,895 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:04,896 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:04,897 transcriptomic_clustering.de_ebayes INFO     Comparing 7 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:05,586 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:05,586 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:05,587 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 0 -- de score: 0
2026-02-25 06:48:05,593 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:05,597 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:05,597 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:05,597 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:05,599 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:05,599 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:05,601 transcriptomic_clustering.de_ebayes INFO     Comparing 4 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:06,026 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:06,027 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:48:06,027 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 5.305050116032362
2026-02-25 06:48:06,027 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:48:06,027 transcriptomic_clustering.markers DEBUG    Generating markers for 10.0 pairs of clusters
2026-02-25 06:48:06,027 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:06,029 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:06,029 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:06,030 transcriptomic_clustering.de_ebayes INFO     Comparing 10 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:07,056 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:48:07,056 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 1.0295784920454025
2026-02-25 06:48:07,057 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:48:07,057 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 8.554517928510904
2026-02-25 06:48:07,057 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:48:10,390 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:48:10,391 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:48:10,392 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0009874887764453888
2026-02-25 06:48:10,392 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/66 [00:00<?, ?it/s]100%|██████████| 66/66 [00:00<00:00, 14549.01it/s]
  0%|          | 0/66 [00:00<?, ?it/s]100%|██████████| 66/66 [00:00<00:00, 11770.23it/s]
2026-02-25 06:48:11,574 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 4 clusters
2026-02-25 06:48:11,575 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 1.1829024441540241
2026-02-25 06:48:11,575 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:48:11,575 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:48:11,576 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:48:11,576 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0014294162392616272
2026-02-25 06:48:11,576 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:48:11,582 transcriptomic_clustering.merging DEBUG    Merging small cluster 3 into 2 -- similarity: 0.8971604409176075
2026-02-25 06:48:11,583 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:48:11,583 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 0.007025580853223801
2026-02-25 06:48:11,583 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:48:11,601 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:48:11,601 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.01786075532436371
2026-02-25 06:48:11,601 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:48:11,601 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:11,601 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:11,607 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:11,607 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:11,607 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:11,609 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:11,609 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:11,611 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:11,895 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:11,896 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:11,896 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 17.288402237292594
2026-02-25 06:48:11,902 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:11,902 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:11,905 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:11,905 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:11,905 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:11,907 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:11,907 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:11,909 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:12,017 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:12,018 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:12,018 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 9.84424927423704
2026-02-25 06:48:12,027 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:48:12,027 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 0.4255995452404022
2026-02-25 06:48:12,027 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:48:12,027 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:48:12,027 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:12,030 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:12,030 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:12,031 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:48:12,325 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:48:12,325 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.2976471893489361
2026-02-25 06:48:12,325 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:48:12,325 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 0.7502659223973751
2026-02-25 06:48:12,325 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:48:12,434 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:48:12,434 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:48:12,436 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0010156333446502686
2026-02-25 06:48:12,436 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/32 [00:00<?, ?it/s]100%|██████████| 32/32 [00:00<00:00, 7404.71it/s]
  0%|          | 0/32 [00:00<?, ?it/s]100%|██████████| 32/32 [00:00<00:00, 6410.86it/s]
2026-02-25 06:48:13,221 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 4 clusters
2026-02-25 06:48:13,221 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.7850465998053551
2026-02-25 06:48:13,221 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:48:13,221 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:48:13,222 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:48:13,222 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0014902278780937195
2026-02-25 06:48:13,222 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:48:13,228 transcriptomic_clustering.merging DEBUG    Merging small cluster 0 into 1 -- similarity: 0.9462515120539895
2026-02-25 06:48:13,232 transcriptomic_clustering.merging DEBUG    Merging small cluster 3 into 1 -- similarity: 0.9059687411606067
2026-02-25 06:48:13,233 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:48:13,233 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 0.01078750565648079
2026-02-25 06:48:13,233 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:48:13,242 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:48:13,242 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.008729144930839539
2026-02-25 06:48:13,242 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:48:13,242 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:13,242 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:13,246 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:13,246 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:13,246 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:13,248 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:13,248 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:13,250 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:13,375 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:13,376 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:13,376 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 0
2026-02-25 06:48:13,381 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:48:13,381 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 0.13896652683615685
2026-02-25 06:48:13,381 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:48:13,381 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:48:13,381 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:13,383 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:13,383 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:13,384 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:48:13,946 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:48:13,946 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.5650768391788006
2026-02-25 06:48:13,946 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:48:13,946 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 0.725720290094614
2026-02-25 06:48:13,947 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:48:14,076 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:48:14,076 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:48:14,077 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.000813797116279602
2026-02-25 06:48:14,077 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/180 [00:00<?, ?it/s]100%|██████████| 180/180 [00:00<00:00, 33675.66it/s]
  0%|          | 0/180 [00:00<?, ?it/s]100%|██████████| 180/180 [00:00<00:00, 571085.26it/s]
2026-02-25 06:48:15,148 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 5 clusters
2026-02-25 06:48:15,148 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 1.070884134620428
2026-02-25 06:48:15,148 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:48:15,148 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:48:15,150 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:48:15,150 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0017527155578136444
2026-02-25 06:48:15,150 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:48:15,150 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:48:15,150 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 4.09446656703949e-05
2026-02-25 06:48:15,150 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:48:15,186 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:48:15,186 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.035878513008356094
2026-02-25 06:48:15,186 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:48:15,186 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:15,194 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:15,194 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:15,194 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:15,196 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:15,197 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:15,198 transcriptomic_clustering.de_ebayes INFO     Comparing 10 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:16,109 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:16,109 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:16,110 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:48:16,115 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 2.728875526827574
2026-02-25 06:48:16,121 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:16,121 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:16,126 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:16,126 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:16,126 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:16,128 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:16,128 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:16,129 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:16,416 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:16,417 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:16,417 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 1 -- de score: 24.520810830963914
2026-02-25 06:48:16,423 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:16,423 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:16,426 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:16,426 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:16,426 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:16,428 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:16,428 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:16,429 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:16,542 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:16,542 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:16,543 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 42.20556885104507
2026-02-25 06:48:16,551 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:48:16,551 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 1.36451022026-02-25 06:48:16,370 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 5 clusters
2026-02-25 06:48:16,370 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.7010686881840229
2026-02-25 06:48:16,370 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:48:16,370 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:48:16,371 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:48:16,371 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.001550581306219101
2026-02-25 06:48:16,371 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:48:16,372 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:48:16,372 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.945082426071167e-05
2026-02-25 06:48:16,372 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:48:16,410 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:48:16,411 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.03883170709013939
2026-02-25 06:48:16,411 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:48:16,411 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:16,418 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:16,418 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:16,419 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:16,422 transcriptomic_clustering.de_ebaye2026-02-25 06:48:19,640 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 6 clusters
2026-02-25 06:48:19,640 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 2.169235836714506
2026-02-25 06:48:19,640 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:48:19,640 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:48:19,641 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:48:19,641 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0016527771949768066
2026-02-25 06:48:19,642 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:48:19,647 transcriptomic_clustering.merging DEBUG    Merging small cluster 0 into 5 -- similarity: 0.6270951545675238
2026-02-25 06:48:19,648 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:48:19,648 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 0.006630904972553253
2026-02-25 06:48:19,648 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:48:19,672 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:48:19,672 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.023498136550188065
2026-02-25 06:48:19,672 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:48:19,672 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:19,678 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:19,678 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:19,678 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:19,681 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:19,681 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:19,682 transcriptomic_clustering.de_ebayes INFO     Comparing 10 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:20,740 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:20,741 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:20,741 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 1 -- de score: 0
2026-02-25 06:48:20,746 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 2 -- de score: 2.4764951585482904
2026-02-25 06:48:20,752 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:20,752 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:20,756 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:20,757 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:20,757 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:20,758 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:20,759 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:20,760 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:21,035 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:21,036 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:21,036 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 1 -- de score: 4.9103885674314585
2026-02-25 06:48:21,041 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:21,041 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:21,044 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:21,045 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:21,045 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:21,046 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:21,047 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:21,048 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:21,155 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:21,155 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:21,156 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 4.870969966587954
2026-02-25 06:48:21,164 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:48:21,164 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 1.4923086687922478
2026-02-25 06:48:21,164 transcriptomic_clustering.2026-02-25 06:48:22,783 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 3 clusters
2026-02-25 06:48:22,784 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 2.1274307295680046
2026-02-25 06:48:22,784 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:48:22,784 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:48:22,785 transcriptomic_clustering.merging INFO     Complete2026-02-25 06:48:22,985 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:48:22,985 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 1.8211604095995426
2026-02-25 06:48:22,986 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:48:22,986 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 3.345883723348379
2026-02-25 06:48:22,986 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:48:23,766 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:48:23,766 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:48:23,767 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0008566603064537048
2026-02-25 06:48:23,767 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/3980 [00:00<?, ?it/s]100%|██████████| 3980/3980 [00:00<00:00, 51034.64it/s]
  0%|          | 0/3980 [00:00<?, ?it/s] 56%|█████▋    | 2245/3980 [00:00<00:00, 20778.96it/s]100%|██████████| 3980/3980 [00:00<00:00, 26039.26it/s]
2026-02-25 06:48:28,423 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 14 clusters
2026-02-25 06:48:28,424 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 4.6565642431378365
2026-02-25 06:48:28,424 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:48:28,424 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:48:28,428 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:48:28,428 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.003931883722543716
2026-02-25 06:48:28,428 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:48:28,428 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:48:28,428 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.709644079208374e-05
2026-02-25 06:48:28,428 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:48:29,371 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:48:29,371 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.942776333540678
2026-02-25 06:48:29,371 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:48:29,371 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:29,386 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:29,386 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:29,386 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:29,389 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:29,389 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:29,391 transcriptomic_clustering.de_ebayes INFO     Comparing 33 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:32,389 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:32,390 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:32,390 transcriptomic_clustering.merging DEBUG    Merging cluster 13 into 6 -- de score: 0
2026-02-25 06:48:32,396 transcriptomic_clustering.merging DEBUG    Merging cluster 8 into 0 -- de score: 0
2026-02-25 06:48:32,403 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 1 -- de score: 26.25376807218457
2026-02-25 06:48:32,410 transcriptomic_clustering.merging DEBUG    Merging cluster 12 into 10 -- de score: 31.225846973672528
2026-02-25 06:48:32,416 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 45.54797368505098
2026-02-25 06:48:32,422 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:32,431 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:32,431 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:32,431 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:32,433 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:32,433 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:32,434 transcriptomic_clustering.de_ebayes INFO     Comparing 16 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:33,948 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:33,949 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:33,949 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:48:33,955 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 5 -- de score: 0
2026-02-25 06:48:33,960 transcriptomic_clustering.merging DEBUG    Merging cluster 10 into 3 -- de score: 0
2026-02-25 06:48:33,966 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:33,972 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:33,972 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:33,972 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:33,974 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:33,974 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:33,975 transcriptomic_clustering.de_ebayes INFO     Comparing 9 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:34,830 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:34,830 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:34,830 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:48:34,837 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 3 -- de score: 221.87558480731084
2026-02-25 06:48:34,843 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:34,843 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:34,848 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:34,848 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:34,848 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:34,850 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:34,850 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:34,851 transcriptomic_clustering.de_ebayes INFO     Comparing 5 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:35,348 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:35,349 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:35,349 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:48:35,355 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:35,355 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:35,359 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:35,359 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:35,359 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:35,361 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:35,361 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:35,363 transcriptomic_clustering.de_ebayes INFO     Comparing 2 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:35,559 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:35,559 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:48:35,559 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 6.188306447118521
2026-02-25 06:48:35,559 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:48:35,559 transcriptomic_clustering.markers DEBUG    Generating markers for 3.0 pairs of clusters
2026-02-25 06:48:35,559 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:35,561 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:35,561 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:35,563 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:36,088 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:48:36,088 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.5286084748804569
2026-02-25 06:48:36,088 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:48:36,088 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 7.664533171802759
2026-02-25 06:48:36,088 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:48:38,857 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:48:38,857 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:48:38,858 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0007492005825042725
2026-02-25 06:48:38,858 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/135 [00:00<?, ?it/s]100%|██████████| 135/135 [00:00<00:00, 31195.58it/s]
  0%|          | 0/135 [00:00<?, ?it/s]100%|██████████| 135/135 [00:00<00:00, 16656.79it/s]
2026-02-25 06:48:39,439 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 3 clusters
2026-02-25 06:48:39,439 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.5816866122186184
2026-02-25 06:48:39,440 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:48:39,440 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:48:39,441 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:48:39,441 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.001311957836151123
2026-02-25 06:48:39,441 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:48:39,441 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:48:39,441 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.674626350402832e-05
2026-02-25 06:48:39,441 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:48:39,467 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:48:39,467 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.026280459016561508
2026-02-25 06:48:39,468 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:48:39,468 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:39,468 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:39,473 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:39,473 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:39,473 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:39,476 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:39,477 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:39,478 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:39,794 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:39,794 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:39,795 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:48:39,801 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:39,801 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:39,804 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:39,804 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:39,804 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:39,806 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:39,806 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:39,808 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:39,924 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:39,925 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:39,925 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:48:39,932 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:48:39,932 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 0.46425340324640274
2026-02-25 06:48:39,932 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:48:39,932 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:48:39,932 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:39,934 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:39,934 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:39,935 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:48:41,320 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:48:41,321 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 1.3887107744812965
2026-02-25 06:48:41,321 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:48:41,321 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 1.8813194930553436
2026-02-25 06:48:41,321 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:48:41,914 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:48:41,914 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:48:41,915 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0010098032653331757
2026-02-25 06:48:41,915 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/719 [00:00<?, ?it/s]100%|██████████| 719/719 [00:00<00:00, 64992.23it/s]
  0%|          | 0/719 [00:00<?, ?it/s]100%|██████████| 719/719 [00:00<00:00, 966571.98it/s]
2026-02-25 06:48:44,863 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 8 clusters
2026-02-25 06:48:44,863 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 2.948490150272846
2026-02-25 06:48:44,864 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:48:44,864 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:48:44,866 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:48:44,866 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.002264373004436493
2026-02-25 06:48:44,866 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:48:44,873 transcriptomic_clustering.merging DEBUG    Merging small cluster 4 into 3 -- similarity: 0.7260451883421508
2026-02-25 06:48:44,874 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:48:44,874 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 0.007806386798620224
2026-02-25 06:48:44,874 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:48:45,007 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:48:45,007 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.1332942247390747
2026-02-25 06:48:45,007 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:48:45,007 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:45,016 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:45,016 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:45,016 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:45,019 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:45,019 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:45,020 transcriptomic_clustering.de_ebayes INFO     Comparing 18 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:47,073 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:47,073 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:47,073 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:48:47,080 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 5 -- de score: 0
2026-02-25 06:48:47,086 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 3 -- de score: 0
2026-02-25 06:48:47,092 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:47,092 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:47,097 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:47,097 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:47,097 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:47,099 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:47,099 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:47,100 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:47,694 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:47,695 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:47,695 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:48:47,701 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 2 -- de score: 0
2026-02-25 06:48:47,707 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:47,707 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:47,711 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:47,711 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:47,711 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:47,713 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:47,713 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:47,714 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:47,827 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:47,828 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:47,829 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:48:47,836 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:48:47,836 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 2.8288103193044662
2026-02-25 06:48:47,836 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:48:47,836 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:48:47,836 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:47,838 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:47,838 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:47,840 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:48:48,290 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:48:48,290 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.45407138019800186
2026-02-25 06:48:48,291 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:48:48,291 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 3.4270534552633762
2026-02-25 06:48:48,291 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:48:48,707 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:48:48,707 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:48:48,708 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0009453520178794861
2026-02-25 06:48:48,708 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/410 [00:00<?, ?it/s]100%|██████████| 410/410 [00:00<00:00, 42183.80it/s]
  0%|          | 0/410 [00:00<?, ?it/s]100%|██████████| 410/410 [00:00<00:00, 943833.50it/s]
2026-02-25 06:48:50,468 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 7 clusters
2026-02-25 06:48:50,468 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 1.7597549594938755
2026-02-25 06:48:50,468 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:48:50,468 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:48:50,470 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:48:50,470 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0020063072443008423
2026-02-25 06:48:50,470 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:48:50,470 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:48:50,470 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 4.939734935760498e-05
2026-02-25 06:48:50,470 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:48:50,527 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:48:50,527 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.05633537098765373
2026-02-25 06:48:50,527 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:48:50,527 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:50,536 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:50,536 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:50,536 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:50,539 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:50,539 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:50,541 transcriptomic_clustering.de_ebayes INFO     Comparing 17 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:52,109 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:52,110 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:52,110 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:48:52,116 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 2 -- de score: 0
2026-02-25 06:48:52,122 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 5 -- de score: 0
2026-02-25 06:48:52,129 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:52,129 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:52,134 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:52,134 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:52,134 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:52,136 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:52,136 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:52,138 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:52,732 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:52,733 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:52,733 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 2 -- de score: 0
2026-02-25 06:48:52,739 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 0 -- de score: 0
2026-02-25 06:48:52,745 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:52,745 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:52,749 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:52,749 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:52,749 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:52,751 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:52,751 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:52,752 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:52,871 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:52,872 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:52,872 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:48:52,878 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:48:52,878 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 2.3511405885219574
2026-02-25 06:48:52,878 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:48:52,878 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:48:52,878 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:52,880 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:52,880 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:52,882 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:48:53,904 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:48:53,904 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 1.0258773528039455
2026-02-25 06:48:53,904 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:48:53,904 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 3.436161123216152
2026-02-25 06:48:53,904 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:48:56,161 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:48:56,162 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:48:56,163 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.000888485461473465
2026-02-25 06:48:56,163 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/422 [00:00<?, ?it/s]100%|██████████| 422/422 [00:00<00:00, 56156.49it/s]
  0%|          | 0/422 [00:00<?, ?it/s]100%|██████████| 422/422 [00:00<00:00, 877104.21it/s]
2026-02-25 06:48:57,514 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 7 clusters
2026-02-25 06:48:57,515 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 1.3518726788461208
2026-02-25 06:48:57,515 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:48:57,515 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:48:57,516 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:48:57,516 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0017117969691753387
2026-02-25 06:48:57,516 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:48:57,516 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:48:57,516 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.758817911148071e-05
2026-02-25 06:48:57,517 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:48:57,586 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:48:57,586 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.06931058689951897
2026-02-25 06:48:57,586 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:48:57,586 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:57,595 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:57,595 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:57,596 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:57,598 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:57,598 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:57,600 transcriptomic_clustering.de_ebayes INFO     Comparing 17 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:59,195 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:59,195 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:59,196 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 1 -- de score: 1.7166955035433389
2026-02-25 06:48:59,201 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 2 -- de score: 31.22385720173939
2026-02-25 06:48:59,207 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 33.266876495653925
2026-02-25 06:48:59,212 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:59,213 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:59,217 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:59,217 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:59,217 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:59,219 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:59,219 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:59,221 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:59,720 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:59,721 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:59,721 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 2 -- de score: 68.04155198989517
2026-02-25 06:48:59,727 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:59,727 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:59,731 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:59,731 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:59,731 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:59,733 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:59,733 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:59,735 transcriptomic_clustering.de_ebayes INFO     Comparing 2 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:48:59,945 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:48:59,945 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:48:59,945 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 14.73547387498171
2026-02-25 06:48:59,951 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:48:59,951 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:48:59,955 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:48:59,955 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:48:59,955 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:48:59,957 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:48:59,957 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:48:59,958 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:00,077 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:00,078 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:49:00,078 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 2.491747483611107
2026-02-25 06:49:00,078 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:49:00,078 transcriptomic_clustering.markers DEBUG    Generating markers for 1.0 pairs of clusters
2026-02-25 06:49:00,078 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:00,080 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:00,080 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:00,082 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:00,384 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:49:00,384 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.3060265779495239
2026-02-25 06:49:00,384 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:49:00,384 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 2.869573011994362
2026-02-25 06:49:00,384 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:49:02,244 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:49:02,244 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:49:02,245 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0009494274854660034
2026-02-25 06:49:02,245 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/263 [00:00<?, ?it/s]100%|██████████| 263/263 [00:00<00:00, 39823.18it/s]
  0%|          | 0/263 [00:00<?, ?it/s]100%|██████████| 263/263 [00:00<00:00, 21001.86it/s]
2026-02-25 06:49:02,920 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 7 clusters
2026-02-25 06:49:02,921 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.6757462434470654
2026-02-25 06:49:02,921 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:49:02,921 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:49:02,922 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:49:02,922 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0016318932175636292
2026-02-25 06:49:02,922 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:49:02,922 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:49:02,923 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.591179847717285e-05
2026-02-25 06:49:02,923 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:49:02,960 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:49:02,960 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.03767517954111099
2026-02-25 06:49:02,960 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:49:02,960 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:02,969 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:02,969 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:02,969 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:02,972 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:02,972 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:02,973 transcriptomic_clustering.de_ebayes INFO     Comparing 17 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:04,537 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:04,538 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:04,538 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 3 -- de score: 0
2026-02-25 06:49:04,544 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 1 -- de score: 1.34233353813124
2026-02-25 06:49:04,550 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 2 -- de score: 11.62856007754823
2026-02-25 06:49:04,556 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:04,556 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:04,561 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:04,561 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:04,561 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:04,563 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:04,563 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:04,565 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:05,072 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:05,073 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:05,073 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 1 -- de score: 9.618852594814738
2026-02-25 06:49:05,079 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:05,079 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:05,083 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:05,083 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:05,083 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:05,084 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:05,085 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:05,086 transcriptomic_clustering.de_ebayes INFO     Comparing 2 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:05,297 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:05,298 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:05,298 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 11.742304355279282
2026-02-25 06:49:05,304 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:05,304 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:05,308 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:05,308 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:05,308 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:05,310 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:05,310 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:05,311 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:05,429 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:05,429 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:05,430 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 57.48156552747005
2026-02-25 06:49:05,436 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:49:05,436 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 2.4755197763442993
2026-02-25 06:49:05,436 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:49:05,436 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:49:05,436 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:05,438 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:05,438 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:05,439 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:49:06,034 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:49:06,034 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.5984864868223667
2026-02-25 06:49:06,035 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:49:06,035 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 3.1139619909226894
2026-02-25 06:49:06,035 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:49:08,837 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:49:08,837 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:49:08,838 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0009824298322200775
2026-02-25 06:49:08,838 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/140 [00:00<?, ?it/s]100%|██████████| 140/140 [00:00<00:00, 26373.35it/s]
  0%|          | 0/140 [00:00<?, ?it/s]100%|██████████| 140/140 [00:00<00:00, 479349.03it/s]
2026-02-25 06:49:11,181 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 4 clusters
2026-02-25 06:49:11,181 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 2.342884313315153
2026-02-25 06:49:11,181 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:49:11,181 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:49:11,183 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:49:11,183 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0014544948935508728
2026-02-25 06:49:11,183 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:49:11,183 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:49:11,183 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 5.286186933517456e-05
2026-02-25 06:49:11,183 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:49:11,206 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:49:11,206 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.02345072105526924
2026-02-25 06:49:11,207 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:49:11,207 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:11,207 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:11,213 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:11,213 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:11,213 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:11,216 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:11,216 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:11,218 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:11,780 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:11,781 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:11,781 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 2.093736555270822
2026-02-25 06:49:11,787 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:11,787 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:11,791 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:11,791 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:11,791 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:11,793 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:11,793 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:11,794 transcriptomic_clustering.de_ebayes INFO     Comparing 2 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:12,000 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:12,001 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:12,001 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 7.3246614636564
2026-02-25 06:49:12,007 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:12,007 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:12,010 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:12,010 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:12,010 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:12,012 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:12,012 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:12,014 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:12,131 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:12,132 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:49:12,132 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 0.9257748760282993
2026-02-25 06:49:12,132 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:49:12,132 transcriptomic_clustering.markers DEBUG    Generating markers for 1.0 pairs of clusters
2026-02-25 06:49:12,133 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:12,135 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:12,135 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:12,137 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:15,776 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:49:15,777 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 3.6440807171165943
2026-02-25 06:49:15,777 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:49:15,777 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 4.595504906028509
2026-02-25 06:49:15,777 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:49:16,719 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:49:16,719 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:49:16,720 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0008582323789596558
2026-02-25 06:49:16,720 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/3149 [00:00<?, ?it/s]100%|██████████| 3149/3149 [00:00<00:00, 57971.69it/s]
  0%|          | 0/3149 [00:00<?, ?it/s] 73%|███████▎  | 2289/3149 [00:00<00:00, 22137.33it/s]100%|██████████| 3149/3149 [00:00<00:00, 25209.84it/s]
2026-02-25 06:49:19,639 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 12 clusters
2026-02-25 06:49:19,639 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 2.9187793023884296
2026-02-25 06:49:19,639 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:49:19,639 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:49:19,643 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:49:19,643 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0036868415772914886
2026-02-25 06:49:19,643 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:49:19,643 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:49:19,643 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 4.262104630470276e-05
2026-02-25 06:49:19,644 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:49:20,362 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:49:20,362 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.7187558263540268
2026-02-25 06:49:20,362 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:49:20,362 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:20,375 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:20,375 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:20,375 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:20,378 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:20,378 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:20,380 transcriptomic_clustering.de_ebayes INFO     Comparing 27 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:22,860 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:22,860 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:22,861 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 0
2026-02-25 06:49:22,868 transcriptomic_clustering.merging DEBUG    Merging cluster 11 into 9 -- de score: 0
2026-02-25 06:49:22,874 transcriptomic_clustering.merging DEBUG    Merging cluster 10 into 1 -- de score: 0
2026-02-25 06:49:22,879 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 0 -- de score: 0
2026-02-25 06:49:22,885 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 5 -- de score: 15.130138873326295
2026-02-25 06:49:22,891 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:22,897 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:22,897 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:22,897 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:22,899 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:22,899 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:22,901 transcriptomic_clustering.de_ebayes INFO     Comparing 16 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:24,387 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:24,388 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:24,388 transcriptomic_clustering.merging DEBUG    Merging cluster 8 into 3 -- de score: 0
2026-02-25 06:49:24,394 transcriptomic_clustering.merging DEBUG    Merging cluster 9 into 2 -- de score: 0
2026-02-25 06:49:24,399 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:24,404 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:24,404 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:24,404 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:24,406 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:24,406 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:24,408 transcriptomic_clustering.de_ebayes INFO     Comparing 7 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:25,020 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:25,021 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:25,021 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 0
2026-02-25 06:49:25,027 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:49:25,033 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:25,033 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:25,038 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:25,038 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:25,038 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:25,040 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:25,040 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:25,041 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:25,347 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:25,348 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:49:25,348 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 4.985399354249239
2026-02-25 06:49:25,348 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:49:25,348 transcriptomic_clustering.markers DEBUG    Generating markers for 3.0 pairs of clusters
2026-02-25 06:49:25,348 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:25,350 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:25,350 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:25,351 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:25,761 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:49:25,761 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.4132104068994522
2026-02-25 06:49:25,761 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:49:25,761 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 6.122072335332632
2026-02-25 06:49:25,761 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:49:27,866 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:49:27,866 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:49:27,867 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0010554604232311249
2026-02-25 06:49:27,867 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/442 [00:00<?, ?it/s]100%|██████████| 442/442 [00:00<00:00, 58832.86it/s]
  0%|          | 0/442 [00:00<?, ?it/s]100%|██████████| 442/442 [00:00<00:00, 1070370.88it/s]
2026-02-25 06:49:28,731 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 7 clusters
2026-02-25 06:49:28,731 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.8643906973302364
2026-02-25 06:49:28,732 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:49:28,732 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:49:28,734 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:49:28,734 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0020480677485466003
2026-02-25 06:49:28,734 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:49:28,734 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:49:28,734 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.707036375999451e-05
2026-02-25 06:49:28,734 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:49:28,806 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:49:28,806 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.0717243067920208
2026-02-25 06:49:28,806 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:49:28,806 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:28,815 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:28,815 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:28,815 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:28,818 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:28,818 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:28,819 transcriptomic_clustering.de_ebayes INFO     Comparing 17 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:30,349 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:30,349 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:30,350 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 3 -- de score: 1.4006512361294963
2026-02-25 06:49:30,356 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 1.49805260864445
2026-02-25 06:49:30,363 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 4 -- de score: 10.140172074544134
2026-02-25 06:49:30,369 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:30,369 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:30,375 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:30,375 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:30,375 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:30,377 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:30,377 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:30,378 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:30,976 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:30,977 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:30,977 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 0 -- de score: 0
2026-02-25 06:49:30,983 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 1 -- de score: 11.794572010814289
2026-02-25 06:49:30,989 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:30,990 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:30,994 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:30,994 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:30,994 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:30,996 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:30,996 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:30,997 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:31,118 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:31,118 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:31,119 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 11.029413966046441
2026-02-25 06:49:31,125 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:49:31,125 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 2.319211073219776
2026-02-25 06:49:31,125 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:49:31,125 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:49:31,125 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:31,127 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:31,127 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:31,129 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:49:31,166 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:49:31,167 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.041611623018980026
2026-02-25 06:49:31,167 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:49:31,167 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 2.4353087544441223
2026-02-25 06:49:31,167 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:49:31,541 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:49:31,541 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:49:31,542 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.000772327184677124
2026-02-25 06:49:31,542 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/228 [00:00<?, ?it/s]100%|██████████| 228/228 [00:00<00:00, 42031.53it/s]
  0%|          | 0/228 [00:00<?, ?it/s]100%|██████████| 228/228 [00:00<00:00, 19098.14it/s]
2026-02-25 06:49:32,091 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 4 clusters
2026-02-25 06:49:32,092 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.5491283759474754
2026-02-25 06:49:32,092 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:49:32,092 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:49:32,093 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:49:32,093 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0015347190201282501
2026-02-25 06:49:32,093 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:49:32,093 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:49:32,093 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.9968639612197876e-05
2026-02-25 06:49:32,093 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:49:32,134 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:49:32,134 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.04035382345318794
2026-02-25 06:49:32,134 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:49:32,134 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:32,134 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:32,141 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:32,141 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:32,141 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:32,144 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:32,144 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:32,146 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:32,748 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:32,749 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:32,749 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 0
2026-02-25 06:49:32,755 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:49:32,761 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:32,761 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:32,765 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:32,765 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:32,765 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:32,767 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:32,767 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:32,768 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:32,888 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:32,888 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:32,889 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 36.812775872291844
2026-02-25 06:49:32,894 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:49:32,894 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 0.7605622708797455
2026-02-25 06:49:32,895 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:49:32,895 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:49:32,895 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:32,896 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:32,897 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:32,898 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:49:32,923 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:49:32,923 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.02851220592856407
2026-02-25 06:49:32,923 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:49:32,923 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 0.8316965438425541
2026-02-25 06:49:32,923 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:49:34,108 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:49:34,108 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:49:34,109 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.001033008098602295
2026-02-25 06:49:34,109 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/3552 [00:00<?, ?it/s]100%|██████████| 3552/3552 [00:00<00:00, 51513.32it/s]
  0%|          | 0/3552 [00:00<?, ?it/s]100%|██████████| 3552/3552 [00:00<00:00, 723106.72it/s]
2026-02-25 06:49:38,877 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 11 clusters
2026-02-25 06:49:38,878 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 4.768523581326008
2026-02-25 06:49:38,878 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:49:38,878 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:49:38,881 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:49:38,881 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.003437742590904236
2026-02-25 06:49:38,881 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:49:38,881 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:49:38,881 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.592297434806824e-05
2026-02-25 06:49:38,882 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:49:39,792 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:49:39,792 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.9105625487864017
2026-02-25 06:49:39,792 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:49:39,792 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:39,805 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:39,805 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:39,805 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:39,808 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:39,808 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:39,810 transcriptomic_clustering.de_ebayes INFO     Comparing 27 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:42,342 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:42,342 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:42,342 transcriptomic_clustering.merging DEBUG    Merging cluster 10 into 9 -- de score: 0
2026-02-25 06:49:42,350 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 4 -- de score: 0
2026-02-25 06:49:42,356 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 3 -- de score: 0
2026-02-25 06:49:42,362 transcriptomic_clustering.merging DEBUG    Merging cluster 8 into 1 -- de score: 0
2026-02-25 06:49:42,368 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:49:42,374 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:42,381 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:42,381 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:42,381 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:42,383 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:42,383 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:42,384 transcriptomic_clustering.de_ebayes INFO     Comparing 13 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:43,609 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:43,610 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:43,610 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 0 -- de score: 0
2026-02-25 06:49:43,616 transcriptomic_clustering.merging DEBUG    Merging cluster 9 into 6 -- de score: 0
2026-02-25 06:49:43,623 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 1 -- de score: 0
2026-02-25 06:49:43,629 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:43,630 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:43,634 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:43,635 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:43,635 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:43,637 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:43,637 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:43,638 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:43,942 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:43,943 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:43,943 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 1 -- de score: 0
2026-02-25 06:49:43,949 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:43,949 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:43,952 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:43,952 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:43,952 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:43,954 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:43,954 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:43,956 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:44,069 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:44,069 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:49:44,069 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 4.2771543972194195
2026-02-25 06:49:44,070 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:49:44,070 transcriptomic_clustering.markers DEBUG    Generating markers for 1.0 pairs of clusters
2026-02-25 06:49:44,070 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:44,073 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:44,073 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:44,075 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:44,247 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:49:44,247 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.17734691500663757
2026-02-25 06:49:44,247 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:49:44,247 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 5.36943656951189
2026-02-25 06:49:44,247 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:49:45,300 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:49:45,300 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:49:45,302 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0011037923395633698
2026-02-25 06:49:45,302 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/727 [00:00<?, ?it/s]100%|██████████| 727/727 [00:00<00:00, 68518.06it/s]
  0%|          | 0/727 [00:00<?, ?it/s]100%|██████████| 727/727 [00:00<00:00, 22006.46it/s]
2026-02-25 06:49:46,290 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 8 clusters
2026-02-25 06:49:46,290 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.9885163642466068
2026-02-25 06:49:46,290 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:49:46,290 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:49:46,292 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:49:46,293 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0021056830883026123
2026-02-25 06:49:46,293 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:49:46,293 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:49:46,293 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.6716461181640625e-05
2026-02-25 06:49:46,293 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:49:46,415 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:49:46,415 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.12191922962665558
2026-02-25 06:49:46,415 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:49:46,415 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:46,425 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:46,425 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:46,425 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:46,428 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:46,428 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:46,430 transcriptomic_clustering.de_ebayes INFO     Comparing 20 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:48,392 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:48,393 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:48,393 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 5 -- de score: 0
2026-02-25 06:49:48,400 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:49:48,407 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 54.682546581682566
2026-02-25 06:49:48,414 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 1 -- de score: 55.919156158389384
2026-02-25 06:49:48,421 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:48,421 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:48,427 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:48,427 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:48,427 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:48,430 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:48,430 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:48,431 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:49,056 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:49,057 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:49,057 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:49:49,064 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 3 -- de score: 0
2026-02-25 06:49:49,070 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:49,070 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:49,074 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:49,074 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:49,074 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:49,077 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:49,077 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:49,078 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:49,199 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:49,199 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:49,200 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:49:49,206 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:49:49,206 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 2.7911096811294556
2026-02-25 06:49:49,206 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:49:49,206 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:49:49,206 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:49,208 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:49,208 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:49,210 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:49:49,237 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:49:49,238 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.03158136457204819
2026-02-25 06:49:49,238 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:49:49,238 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 2.9474862180650234
2026-02-25 06:49:49,238 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:49:49,404 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:49:49,405 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:49:49,406 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0008954331278800964
2026-02-25 06:49:49,406 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/395 [00:00<?, ?it/s]100%|██████████| 395/395 [00:00<00:00, 58693.81it/s]
  0%|          | 0/395 [00:00<?, ?it/s]100%|██████████| 395/395 [00:00<00:00, 19359.08it/s]
2026-02-25 06:49:50,206 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 6 clusters
2026-02-25 06:49:50,206 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.8000506311655045
2026-02-25 06:49:50,206 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:49:50,206 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:49:50,208 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:49:50,208 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.002007868140935898
2026-02-25 06:49:50,208 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:49:50,208 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:49:50,208 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.654509782791138e-05
2026-02-25 06:49:50,208 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:49:50,270 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:49:50,270 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.06191110983490944
2026-02-25 06:49:50,270 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:49:50,270 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:50,279 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:50,279 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:50,279 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:50,282 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:50,282 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:50,284 transcriptomic_clustering.de_ebayes INFO     Comparing 14 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:51,612 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:51,613 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:51,613 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 0
2026-02-25 06:49:51,619 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 0
2026-02-25 06:49:51,626 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:51,626 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:51,632 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:51,632 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:51,632 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:51,635 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:51,635 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:51,637 transcriptomic_clustering.de_ebayes INFO     Comparing 5 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:52,161 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:52,161 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:52,162 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:49:52,168 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:52,168 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:52,173 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:52,173 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:52,173 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:52,175 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:52,175 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:52,177 transcriptomic_clustering.de_ebayes INFO     Comparing 2 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:52,377 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:52,378 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:52,378 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:49:52,384 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:52,384 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:52,388 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:52,388 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:52,388 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:52,390 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:52,390 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:52,392 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:52,509 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:52,510 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:49:52,510 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 2.239513587206602
2026-02-25 06:49:52,510 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:49:52,510 transcriptomic_clustering.markers DEBUG    Generating markers for 1.0 pairs of clusters
2026-02-25 06:49:52,510 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:52,513 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:52,513 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:52,515 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:52,702 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:49:52,702 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.19194559380412102
2026-02-25 06:49:52,702 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:49:52,702 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 2.4961898773908615
2026-02-25 06:49:52,702 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:49:53,273 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:49:53,273 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:49:53,274 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0009112544357776642
2026-02-25 06:49:53,274 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/608 [00:00<?, ?it/s]100%|██████████| 608/608 [00:00<00:00, 52706.20it/s]
  0%|          | 0/608 [00:00<?, ?it/s]100%|██████████| 608/608 [00:00<00:00, 23964.75it/s]
2026-02-25 06:49:55,782 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 6 clusters
2026-02-25 06:49:55,782 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 2.5085441693663597
2026-02-25 06:49:55,783 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:49:55,783 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:49:55,785 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:49:55,785 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0020119063556194305
2026-02-25 06:49:55,785 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:49:55,785 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:49:55,785 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 4.052743315696716e-05
2026-02-25 06:49:55,785 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:49:55,902 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:49:55,902 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.1167498342692852
2026-02-25 06:49:55,902 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:49:55,902 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:55,911 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:55,911 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:55,911 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:55,914 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:55,914 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:55,915 transcriptomic_clustering.de_ebayes INFO     Comparing 13 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:57,136 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:57,137 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:57,137 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:49:57,143 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 0
2026-02-25 06:49:57,149 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 2 -- de score: 0
2026-02-25 06:49:57,155 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:57,155 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:57,159 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:57,159 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:57,159 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:57,161 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:57,161 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:57,163 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:57,482 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:57,483 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:49:57,483 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 2 -- de score: 41.92657921563912
2026-02-25 06:49:57,490 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:49:57,490 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:49:57,494 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:49:57,494 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:49:57,494 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:57,496 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:57,496 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:57,497 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:57,616 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:49:57,617 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:49:57,617 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 1.7155816033482552
2026-02-25 06:49:57,617 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:49:57,617 transcriptomic_clustering.markers DEBUG    Generating markers for 1.0 pairs of clusters
2026-02-25 06:49:57,617 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:49:57,620 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:49:57,620 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:49:57,621 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:49:58,713 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:49:58,713 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 1.0954369232058525
2026-02-25 06:49:58,713 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:49:58,713 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 2.930611040443182
2026-02-25 06:49:58,713 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:00,396 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:00,397 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:00,397 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0007962584495544434
2026-02-25 06:50:00,398 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/129 [00:00<?, ?it/s]100%|██████████| 129/129 [00:00<00:00, 25080.67it/s]
  0%|          | 0/129 [00:00<?, ?it/s]100%|██████████| 129/129 [00:00<00:00, 76002.98it/s]
2026-02-25 06:50:01,607 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 4 clusters
2026-02-25 06:50:01,608 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 1.2098948620259762
2026-02-25 06:50:01,608 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:01,608 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:01,609 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:01,609 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0016875378787517548
2026-02-25 06:50:01,609 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:01,609 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:01,609 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.8545578718185425e-05
2026-02-25 06:50:01,610 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:01,633 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:01,633 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.023468900471925735
2026-02-25 06:50:01,633 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:01,633 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:01,633 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:01,640 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:01,640 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:01,640 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:01,643 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:01,643 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:01,645 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:02,225 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:02,225 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:02,226 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 0
2026-02-25 06:50:02,232 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 17.803399496516676
2026-02-25 06:50:02,239 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:02,239 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:02,243 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:02,243 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:02,243 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:02,245 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:02,245 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:02,247 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:02,365 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:02,366 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:02,367 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 25.684784202499394
2026-02-25 06:50:02,373 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:02,373 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 0.7396447062492371
2026-02-25 06:50:02,373 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:02,373 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:50:02,373 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:02,375 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:02,375 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:02,377 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:50:02,975 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:02,975 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.6020811162889004
2026-02-25 06:50:02,975 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:02,975 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 1.3676910623908043
2026-02-25 06:50:02,975 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:03,182 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:03,183 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:03,184 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0010367780923843384
2026-02-25 06:50:03,184 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/63 [00:00<?, ?it/s]100%|██████████| 63/63 [00:00<00:00, 19439.50it/s]
  0%|          | 0/63 [00:00<?, ?it/s]100%|██████████| 63/63 [00:00<00:00, 10597.20it/s]
2026-02-25 06:50:03,762 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 3 clusters
2026-02-25 06:50:03,762 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.5781129635870457
2026-02-25 06:50:03,762 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:03,762 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:03,763 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:03,763 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.001402348279953003
2026-02-25 06:50:03,763 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:03,763 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:03,764 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 4.025548696517944e-05
2026-02-25 06:50:03,764 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:03,779 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:03,779 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.015347402542829514
2026-02-25 06:50:03,779 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:03,779 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:03,779 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:03,785 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:03,785 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:03,785 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:03,788 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:03,788 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:03,790 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:04,097 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:04,098 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:04,098 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 3.566789065612202
2026-02-25 06:50:04,104 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:04,104 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:04,107 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:04,107 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:04,108 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:04,109 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:04,110 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:04,111 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:04,232 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:04,232 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:04,233 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 43.931750286468656
2026-02-25 06:50:04,238 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:04,239 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 0.45948852598667145
2026-02-25 06:50:04,239 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:04,239 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:50:04,239 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:04,241 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:04,241 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:04,242 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:50:04,268 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:04,268 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.029761571437120438
2026-02-25 06:50:04,269 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:04,269 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 0.5067379586398602
2026-02-25 06:50:04,269 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:04,380 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:04,380 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:04,381 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.000963158905506134
2026-02-25 06:50:04,381 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/50 [00:00<?, ?it/s]100%|██████████| 50/50 [00:00<00:00, 10621.72it/s]
  0%|          | 0/50 [00:00<?, ?it/s]100%|██████████| 50/50 [00:00<00:00, 7416.20it/s]
2026-02-25 06:50:05,013 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 2 clusters
2026-02-25 06:50:05,013 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.6321200840175152
2026-02-25 06:50:05,013 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:05,014 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:05,015 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:05,015 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0012538284063339233
2026-02-25 06:50:05,015 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:05,015 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:05,015 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.6522746086120605e-05
2026-02-25 06:50:05,015 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:05,029 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:05,029 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.013785474002361298
2026-02-25 06:50:05,029 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:05,029 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:05,029 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:05,034 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:05,034 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:05,034 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:05,037 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:05,037 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:05,039 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:05,170 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:05,170 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:05,170 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:50:05,176 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:05,176 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 0.147112924605608
2026-02-25 06:50:05,176 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:05,176 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:50:05,176 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:05,178 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:05,178 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:05,180 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:50:05,205 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:05,205 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.028573375195264816
2026-02-25 06:50:05,205 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:05,205 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 0.1914297603070736
2026-02-25 06:50:05,205 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:05,345 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:05,346 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:05,346 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0008803047239780426
2026-02-25 06:50:05,347 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/264 [00:00<?, ?it/s]100%|██████████| 264/264 [00:00<00:00, 40152.89it/s]
  0%|          | 0/264 [00:00<?, ?it/s]100%|██████████| 264/264 [00:00<00:00, 18026.80it/s]
2026-02-25 06:50:05,956 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 7 clusters
2026-02-25 06:50:05,956 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.609712865203619
2026-02-25 06:50:05,956 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:05,956 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:05,958 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:05,959 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0020134001970291138
2026-02-25 06:50:05,959 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:05,959 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:05,959 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 5.247071385383606e-05
2026-02-25 06:50:05,959 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:06,004 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:06,004 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.04507596790790558
2026-02-25 06:50:06,004 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:06,004 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:06,014 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:06,014 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:06,014 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:06,017 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:06,017 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:06,019 transcriptomic_clustering.de_ebayes INFO     Comparing 16 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:07,510 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:07,510 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:07,511 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 0
2026-02-25 06:50:07,516 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 0 -- de score: 13.144787861862094
2026-02-25 06:50:07,522 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 1 -- de score: 94.9523160495131
2026-02-25 06:50:07,527 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:07,527 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:07,532 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:07,533 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:07,533 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:07,534 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:07,535 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:07,536 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:08,107 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:08,107 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:08,108 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 2 -- de score: 3.807055108605709
2026-02-25 06:50:08,114 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 26.96945438947045
2026-02-25 06:50:08,120 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:08,120 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:08,124 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:08,124 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:08,124 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:08,126 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:08,126 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:08,127 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:08,249 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:08,249 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:08,249 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 2.2453682236373425
2026-02-25 06:50:08,249 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:08,249 transcriptomic_clustering.markers DEBUG    Generating markers for 1.0 pairs of clusters
2026-02-25 06:50:08,249 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:08,251 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:08,252 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:08,253 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:08,435 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:08,435 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.18601194769144058
2026-02-25 06:50:08,436 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:08,436 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 2.479190729558468
2026-02-25 06:50:08,436 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:08,788 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:08,788 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:08,789 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0010266229510307312
2026-02-25 06:50:08,789 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/128 [00:00<?, ?it/s]100%|██████████| 128/128 [00:00<00:00, 26583.03it/s]
  0%|          | 0/128 [00:00<?, ?it/s]100%|██████████| 128/128 [00:00<00:00, 473849.00it/s]
2026-02-25 06:50:09,673 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 5 clusters
2026-02-25 06:50:09,673 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.8833401501178741
2026-02-25 06:50:09,673 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:09,673 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:09,674 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:09,674 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0015854500234127045
2026-02-25 06:50:09,675 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:09,675 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:09,675 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.610923886299133e-05
2026-02-25 06:50:09,675 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:09,698 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:09,698 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.023515578359365463
2026-02-25 06:50:09,698 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:09,698 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:09,706 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:09,706 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:09,706 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:09,709 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:09,709 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:09,711 transcriptomic_clustering.de_ebayes INFO     Comparing 10 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:10,696 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:10,697 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:10,697 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:50:10,703 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 2 -- de score: 0
2026-02-25 06:50:10,709 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:10,709 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:10,713 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:10,714 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:10,714 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:10,716 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:10,716 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:10,717 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:10,995 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:10,996 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:10,996 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 7.148513443008136
2026-02-25 06:50:11,002 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:11,002 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:11,005 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:11,005 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:11,005 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:11,007 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:11,007 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:11,008 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:11,114 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:11,115 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:11,116 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 18.078524794581995
2026-02-25 06:50:11,124 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:11,124 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 1.4257429875433445
2026-02-25 06:50:11,124 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:11,124 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:50:11,124 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:11,128 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:11,128 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:11,129 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:50:11,151 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:11,151 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.027071643620729446
2026-02-25 06:50:11,151 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:11,152 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 1.4786554984748363
2026-02-25 06:50:11,152 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:11,463 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:11,463 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:11,464 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0009235963225364685
2026-02-25 06:50:11,464 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/68 [00:00<?, ?it/s]100%|██████████| 68/68 [00:00<00:00, 14745.01it/s]
  0%|          | 0/68 [00:00<?, ?it/s]100%|██████████| 68/68 [00:00<00:00, 9962.37it/s]
2026-02-25 06:50:12,108 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 3 clusters
2026-02-25 06:50:12,108 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.6445733495056629
2026-02-25 06:50:12,109 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:12,109 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:12,110 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:12,110 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0016205161809921265
2026-02-25 06:50:12,110 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:12,110 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:12,110 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 5.338713526725769e-05
2026-02-25 06:50:12,110 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:12,127 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:12,127 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.016164332628250122
2026-02-25 06:50:12,127 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:12,127 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:12,127 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:12,133 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:12,133 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:12,133 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:12,136 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:12,136 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:12,138 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:12,451 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:12,451 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:12,451 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:50:12,457 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:12,457 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:12,460 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:12,461 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:12,461 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:12,462 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:12,463 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:12,464 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:12,581 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:12,582 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:12,582 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 6.619120267074549
2026-02-25 06:50:12,589 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:12,589 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 0.46206429973244667
2026-02-25 06:50:12,589 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:12,589 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:50:12,589 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:12,591 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:12,591 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:12,593 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:50:13,047 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:13,047 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.45779844373464584
2026-02-25 06:50:13,047 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:13,047 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 0.9383626393973827
2026-02-25 06:50:13,047 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:13,223 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:13,223 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:13,224 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0008336491882801056
2026-02-25 06:50:13,224 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/401 [00:00<?, ?it/s]100%|██████████| 401/401 [00:00<00:00, 69203.25it/s]
  0%|          | 0/401 [00:00<?, ?it/s]100%|██████████| 401/401 [00:00<00:00, 19380.71it/s]
2026-02-25 06:50:14,468 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 6 clusters
2026-02-25 06:50:14,468 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 1.2442355081439018
2026-02-25 06:50:14,468 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:14,468 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:14,470 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:14,470 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0017072856426239014
2026-02-25 06:50:14,470 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:14,470 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:14,470 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.634020686149597e-05
2026-02-25 06:50:14,470 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:14,539 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:14,539 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.06923986971378326
2026-02-25 06:50:14,539 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:14,540 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:14,548 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:14,548 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:14,548 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:14,551 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:14,551 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:14,552 transcriptomic_clustering.de_ebayes INFO     Comparing 14 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:15,830 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:15,831 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:15,831 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 2 -- de score: 0
2026-02-25 06:50:15,837 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 3.6326952628823115
2026-02-25 06:50:15,844 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 4 -- de score: 53.20088561555404
2026-02-25 06:50:15,849 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:15,850 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:15,854 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:15,854 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:15,854 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:15,856 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:15,857 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:15,858 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:16,169 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:16,169 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:16,170 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:50:16,175 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:16,175 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:16,179 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:16,179 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:16,179 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:16,181 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:16,181 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:16,182 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:16,294 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:16,295 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:16,295 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 0 -- de score: 0
2026-02-25 06:50:16,303 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:16,303 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 1.763639196753502
2026-02-25 06:50:16,303 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:16,303 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:50:16,303 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:16,305 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:16,305 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:16,307 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:50:16,328 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:16,328 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.02445891872048378
2026-02-25 06:50:16,328 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:16,328 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 1.8597918264567852
2026-02-25 06:50:16,328 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:16,718 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:16,718 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:16,719 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0007640048861503601
2026-02-25 06:50:16,719 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/671 [00:00<?, ?it/s]100%|██████████| 671/671 [00:00<00:00, 64280.15it/s]
  0%|          | 0/671 [00:00<?, ?it/s]100%|██████████| 671/671 [00:00<00:00, 20837.37it/s]
2026-02-25 06:50:17,754 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 8 clusters
2026-02-25 06:50:17,754 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 1.0344831831753254
2026-02-25 06:50:17,754 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:17,754 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:17,756 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:17,756 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.002225145697593689
2026-02-25 06:50:17,756 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:17,756 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:17,756 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 4.038587212562561e-05
2026-02-25 06:50:17,757 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:17,884 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:17,884 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.12721238285303116
2026-02-25 06:50:17,884 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:17,884 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:17,894 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:17,894 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:17,894 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:17,897 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:17,897 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:17,898 transcriptomic_clustering.de_ebayes INFO     Comparing 20 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:19,720 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:19,721 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:19,721 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 0
2026-02-25 06:50:19,727 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 0 -- de score: 0
2026-02-25 06:50:19,734 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 1 -- de score: 0
2026-02-25 06:50:19,740 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 2 -- de score: 26.27386698907639
2026-02-25 06:50:19,746 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:19,746 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:19,751 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:19,751 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:19,751 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:19,753 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:19,753 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:19,755 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:20,364 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:20,365 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:20,365 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:50:20,371 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 2 -- de score: 0
2026-02-25 06:50:20,377 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:20,377 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:20,381 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:20,381 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:20,381 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:20,383 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:20,383 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:20,384 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:20,501 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:20,502 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:20,503 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:50:20,509 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:20,509 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 2.624822970479727
2026-02-25 06:50:20,509 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:20,509 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:50:20,509 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:20,511 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:20,511 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:20,512 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:50:20,732 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:20,732 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.22304673120379448
2026-02-25 06:50:20,732 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:20,732 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 2.9780070297420025
2026-02-25 06:50:20,732 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:20,903 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:20,903 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:20,904 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0006930194795131683
2026-02-25 06:50:20,904 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/47 [00:00<?, ?it/s]100%|██████████| 47/47 [00:00<00:00, 9331.71it/s]
  0%|          | 0/47 [00:00<?, ?it/s]100%|██████████| 47/47 [00:00<00:00, 8186.22it/s]
2026-02-25 06:50:21,404 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 3 clusters
2026-02-25 06:50:21,404 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.5000758096575737
2026-02-25 06:50:21,404 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:21,405 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:21,406 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:21,406 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0013026334345340729
2026-02-25 06:50:21,406 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:21,411 transcriptomic_clustering.merging DEBUG    Merging small cluster 2 into 0 -- similarity: 0.9342045580848166
2026-02-25 06:50:21,412 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:21,412 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 0.006357807666063309
2026-02-25 06:50:21,412 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:21,424 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:21,424 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.01191205158829689
2026-02-25 06:50:21,424 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:21,424 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:21,424 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:21,429 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:21,429 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:21,429 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:21,431 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:21,432 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:21,433 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:21,562 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:21,562 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:21,563 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 3.1598885495743203
2026-02-25 06:50:21,568 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:21,568 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 0.1438170000910759
2026-02-25 06:50:21,568 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:21,568 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:50:21,568 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:21,570 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:21,570 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:21,572 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:50:23,143 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:23,143 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 1.5751275308430195
2026-02-25 06:50:23,144 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:23,144 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 1.7391546294093132
2026-02-25 06:50:23,144 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:23,594 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:23,594 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:23,595 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0009101703763008118
2026-02-25 06:50:23,595 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/187 [00:00<?, ?it/s]100%|██████████| 187/187 [00:00<00:00, 36271.50it/s]
  0%|          | 0/187 [00:00<?, ?it/s]100%|██████████| 187/187 [00:00<00:00, 753443.66it/s]
2026-02-25 06:50:24,210 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 5 clusters
2026-02-25 06:50:24,211 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.615315392613411
2026-02-25 06:50:24,211 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:24,211 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:24,212 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:24,212 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0015570148825645447
2026-02-25 06:50:24,212 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:24,212 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:24,212 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 6.974488496780396e-05
2026-02-25 06:50:24,213 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:24,248 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:24,248 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.03540259227156639
2026-02-25 06:50:24,248 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:24,248 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:24,255 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:24,255 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:24,256 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:24,258 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:24,258 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:24,260 transcriptomic_clustering.de_ebayes INFO     Comparing 10 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:25,198 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:25,198 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:25,198 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 0
2026-02-25 06:50:25,204 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 10.277457174396918
2026-02-25 06:50:25,210 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:25,210 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:25,215 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:25,215 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:25,216 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:25,218 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:25,218 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:25,220 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:25,531 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:25,531 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:25,532 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:50:25,538 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:25,538 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:25,541 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:25,541 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:25,541 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:25,543 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:25,543 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:25,545 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:25,664 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:25,664 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:25,665 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 55.097781202619
2026-02-25 06:50:25,670 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:25,670 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 1.422365590929985
2026-02-25 06:50:25,670 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:25,670 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:50:25,671 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:25,672 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:25,673 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:25,674 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:50:26,102 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:26,103 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.4320796839892864
2026-02-25 06:50:26,103 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:26,103 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 1.8920849151909351
2026-02-25 06:50:26,103 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:26,199 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:26,199 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:26,200 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0008574649691581726
2026-02-25 06:50:26,200 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/63 [00:00<?, ?it/s]100%|██████████| 63/63 [00:00<00:00, 12983.55it/s]
  0%|          | 0/63 [00:00<?, ?it/s]100%|██████████| 63/63 [00:00<00:00, 277272.98it/s]
2026-02-25 06:50:27,610 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 3 clusters
2026-02-25 06:50:27,610 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 1.4106782637536526
2026-02-25 06:50:27,610 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:27,610 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:27,612 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:27,612 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0012077130377292633
2026-02-25 06:50:27,612 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:27,612 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:27,612 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 4.585832357406616e-05
2026-02-25 06:50:27,612 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:27,625 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:27,626 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.01366335153579712
2026-02-25 06:50:27,626 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:27,626 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:27,626 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:27,632 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:27,632 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:27,632 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:27,634 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:27,635 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:27,636 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:27,908 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:27,908 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:27,909 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:50:27,914 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:27,914 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:27,917 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:27,917 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:27,917 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:27,919 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:27,919 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:27,921 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:28,033 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:28,034 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:28,035 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 15.042476235872936
2026-02-25 06:50:28,042 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:28,042 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 0.4166688434779644
2026-02-25 06:50:28,042 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:28,042 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:50:28,042 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:28,044 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:28,044 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:28,046 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:50:28,334 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:28,334 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.2920517809689045
2026-02-25 06:50:28,335 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:28,335 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 0.7242623083293438
2026-02-25 06:50:28,335 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:29,602 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:29,602 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:29,603 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0007736310362815857
2026-02-25 06:50:29,603 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/3692 [00:00<?, ?it/s]100%|██████████| 3692/3692 [00:00<00:00, 50219.29it/s]
  0%|          | 0/3692 [00:00<?, ?it/s] 53%|█████▎    | 1969/3692 [00:00<00:00, 18575.02it/s]100%|██████████| 3692/3692 [00:00<00:00, 24582.72it/s]
2026-02-25 06:50:32,904 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 14 clusters
2026-02-25 06:50:32,905 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 3.3017548471689224
2026-02-25 06:50:32,905 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:32,905 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:32,909 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:32,909 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0038372911512851715
2026-02-25 06:50:32,909 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:32,909 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:32,909 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.7688761949539185e-05
2026-02-25 06:50:32,909 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:33,682 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:33,682 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.772975493222475
2026-02-25 06:50:33,682 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:33,682 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:33,698 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:33,698 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:33,698 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:33,701 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:33,701 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:33,702 transcriptomic_clustering.de_ebayes INFO     Comparing 31 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:36,939 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:36,940 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:36,940 transcriptomic_clustering.merging DEBUG    Merging cluster 12 into 11 -- de score: 0
2026-02-25 06:50:36,947 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 4 -- de score: 0
2026-02-25 06:50:36,953 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 3 -- de score: 0
2026-02-25 06:50:36,958 transcriptomic_clustering.merging DEBUG    Merging cluster 10 into 8 -- de score: 0
2026-02-25 06:50:36,964 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 125.00871314358817
2026-02-25 06:50:36,970 transcriptomic_clustering.merging DEBUG    Merging cluster 13 into 7 -- de score: 127.71196479508293
2026-02-25 06:50:36,975 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:36,983 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:36,983 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:36,983 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:36,984 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:36,985 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:36,986 transcriptomic_clustering.de_ebayes INFO     Comparing 17 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:38,589 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:38,589 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:38,589 transcriptomic_clustering.merging DEBUG    Merging cluster 11 into 9 -- de score: 0
2026-02-25 06:50:38,595 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:50:38,600 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 1 -- de score: 34.401875239680805
2026-02-25 06:50:38,606 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:38,611 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:38,611 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:38,611 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:38,613 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:38,613 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:38,614 transcriptomic_clustering.de_ebayes INFO     Comparing 9 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:39,430 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:39,430 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:39,431 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 0 -- de score: 0
2026-02-25 06:50:39,436 transcriptomic_clustering.merging DEBUG    Merging cluster 9 into 1 -- de score: 0
2026-02-25 06:50:39,443 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:39,443 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:39,447 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:39,447 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:39,447 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:39,449 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:39,449 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:39,451 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:39,766 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:39,766 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:39,767 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:50:39,772 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:39,773 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:39,776 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:39,776 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:39,776 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:39,778 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:39,778 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:39,780 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:39,901 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:39,901 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:39,901 transcriptomic_clustering.merging DEBUG    Merging cluster 8 into 0 -- de score: 0
2026-02-25 06:50:39,907 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:39,907 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 6.22490706294775
2026-02-25 06:50:39,907 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:39,907 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:50:39,907 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:39,909 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:39,909 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:39,911 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:50:40,251 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:40,251 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.3440067693591118
2026-02-25 06:50:40,251 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:40,251 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 7.346743319183588
2026-02-25 06:50:40,251 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:40,372 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:40,373 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:40,373 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0008017607033252716
2026-02-25 06:50:40,373 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/132 [00:00<?, ?it/s]100%|██████████| 132/132 [00:00<00:00, 26301.57it/s]
  0%|          | 0/132 [00:00<?, ?it/s]100%|██████████| 132/132 [00:00<00:00, 16859.98it/s]
2026-02-25 06:50:41,512 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 6 clusters
2026-02-25 06:50:41,512 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 1.1386322975158691
2026-02-25 06:50:41,512 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:41,512 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:41,514 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:41,514 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0016716793179512024
2026-02-25 06:50:41,514 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:41,520 transcriptomic_clustering.merging DEBUG    Merging small cluster 5 into 4 -- similarity: 0.9129528496417795
2026-02-25 06:50:41,526 transcriptomic_clustering.merging DEBUG    Merging small cluster 0 into 2 -- similarity: 0.8827429737697475
2026-02-25 06:50:41,527 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:41,527 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 0.012894898653030396
2026-02-25 06:50:41,527 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:41,549 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:41,549 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.021975204348564148
2026-02-25 06:50:41,549 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:41,549 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:41,549 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:41,555 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:41,555 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:41,555 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:41,558 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:41,558 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:41,560 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:42,125 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:42,126 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:42,126 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 1 -- de score: 0
2026-02-25 06:50:42,131 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 2 -- de score: 1.6939362962987041
2026-02-25 06:50:42,137 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:42,137 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:42,140 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:42,140 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:42,140 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:42,142 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:42,142 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:42,144 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:42,258 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:42,259 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:42,259 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 0
2026-02-25 06:50:42,266 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:42,266 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 0.7170914188027382
2026-02-25 06:50:42,266 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:42,266 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:50:42,266 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:42,268 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:42,268 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:42,270 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:50:43,517 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:43,517 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 1.2505542822182178
2026-02-25 06:50:43,517 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:43,517 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 2.0048663169145584
2026-02-25 06:50:43,517 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:43,970 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:43,970 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:43,971 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.000821433961391449
2026-02-25 06:50:43,971 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/2973 [00:00<?, ?it/s]100%|██████████| 2973/2973 [00:00<00:00, 56703.50it/s]
  0%|          | 0/2973 [00:00<?, ?it/s] 80%|███████▉  | 2377/2973 [00:00<00:00, 22702.58it/s]100%|██████████| 2973/2973 [00:00<00:00, 25032.30it/s]
2026-02-25 06:50:47,291 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 12 clusters
2026-02-25 06:50:47,291 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 3.319989200681448
2026-02-25 06:50:47,291 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:47,291 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:47,295 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:47,295 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.003399170935153961
2026-02-25 06:50:47,295 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:47,295 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:47,295 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.6910176277160645e-05
2026-02-25 06:50:47,295 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:47,848 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:47,848 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.5526019036769867
2026-02-25 06:50:47,848 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:47,848 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:47,860 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:47,860 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:47,860 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:47,863 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:47,863 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:47,865 transcriptomic_clustering.de_ebayes INFO     Comparing 32 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:50,910 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:50,910 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:50,911 transcriptomic_clustering.merging DEBUG    Merging cluster 9 into 7 -- de score: 0
2026-02-25 06:50:50,917 transcriptomic_clustering.merging DEBUG    Merging cluster 10 into 1 -- de score: 0
2026-02-25 06:50:50,924 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 3 -- de score: 0
2026-02-25 06:50:50,931 transcriptomic_clustering.merging DEBUG    Merging cluster 11 into 8 -- de score: 0
2026-02-25 06:50:50,938 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 4 -- de score: 0
2026-02-25 06:50:50,944 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:50:50,951 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:50,959 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:50,959 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:50,959 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:50,961 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:50,961 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:50,963 transcriptomic_clustering.de_ebayes INFO     Comparing 13 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:52,167 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:52,168 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:52,168 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:50:52,173 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 0
2026-02-25 06:50:52,179 transcriptomic_clustering.merging DEBUG    Merging cluster 8 into 7 -- de score: 0
2026-02-25 06:50:52,185 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:52,185 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:52,189 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:52,189 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:52,189 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:52,191 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:52,191 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:52,192 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:52,492 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:52,493 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:52,493 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 0 -- de score: 0
2026-02-25 06:50:52,499 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:52,499 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:52,503 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:52,503 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:52,503 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:52,505 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:52,505 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:52,506 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:52,625 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:52,626 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:52,626 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:50:52,632 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:52,632 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 4.7841308899223804
2026-02-25 06:50:52,632 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:52,632 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:50:52,632 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:52,634 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:52,634 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:52,636 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:50:52,661 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:52,661 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.028669387102127075
2026-02-25 06:50:52,661 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:52,661 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 5.3697069846093655
2026-02-25 06:50:52,661 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:52,791 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:52,791 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:52,793 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0010070838034152985
2026-02-25 06:50:52,793 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/29 [00:00<?, ?it/s]100%|██████████| 29/29 [00:00<00:00, 6635.83it/s]
  0%|          | 0/29 [00:00<?, ?it/s]100%|██████████| 29/29 [00:00<00:00, 6052.69it/s]
2026-02-25 06:50:53,517 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 3 clusters
2026-02-25 06:50:53,517 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.7242522649466991
2026-02-25 06:50:53,517 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:53,517 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:53,518 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:53,518 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.001260470598936081
2026-02-25 06:50:53,518 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:53,524 transcriptomic_clustering.merging DEBUG    Merging small cluster 1 into 0 -- similarity: 0.8305432037117806
2026-02-25 06:50:53,525 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:53,525 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 0.006394911557435989
2026-02-25 06:50:53,525 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:53,533 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:53,533 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.007861491292715073
2026-02-25 06:50:53,533 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:53,533 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:53,533 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:50:53,537 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:53,537 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:53,537 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:53,540 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:53,540 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:53,542 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:53,665 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:53,665 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:53,666 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 15.185522353665085
2026-02-25 06:50:53,671 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:50:53,671 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 0.1380489207804203
2026-02-25 06:50:53,671 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:50:53,671 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:50:53,671 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:53,673 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:53,673 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:53,675 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:50:54,976 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:50:54,977 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 1.3056832030415535
2026-02-25 06:50:54,977 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:50:54,977 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 1.4598627015948296
2026-02-25 06:50:54,977 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:50:55,255 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:50:55,255 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:50:55,256 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.000816095620393753
2026-02-25 06:50:55,256 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/1368 [00:00<?, ?it/s]100%|██████████| 1368/1368 [00:00<00:00, 64090.97it/s]
  0%|          | 0/1368 [00:00<?, ?it/s]100%|██████████| 1368/1368 [00:00<00:00, 23689.98it/s]
2026-02-25 06:50:56,671 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 10 clusters
2026-02-25 06:50:56,671 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 1.4143877439200878
2026-02-25 06:50:56,671 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:50:56,671 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:50:56,674 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:50:56,674 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.002672255039215088
2026-02-25 06:50:56,674 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:50:56,674 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:50:56,674 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.692135214805603e-05
2026-02-25 06:50:56,674 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:50:56,927 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:50:56,927 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.2528579346835613
2026-02-25 06:50:56,927 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:50:56,927 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:56,938 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:56,939 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:56,939 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:56,941 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:56,942 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:56,943 transcriptomic_clustering.de_ebayes INFO     Comparing 24 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:50:59,096 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:50:59,097 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:50:59,097 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 3 -- de score: 0
2026-02-25 06:50:59,103 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 5 -- de score: 0
2026-02-25 06:50:59,109 transcriptomic_clustering.merging DEBUG    Merging cluster 8 into 0 -- de score: 0
2026-02-25 06:50:59,115 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 48.63825601246596
2026-02-25 06:50:59,120 transcriptomic_clustering.merging DEBUG    Merging cluster 9 into 4 -- de score: 71.72931792056752
2026-02-25 06:50:59,126 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:50:59,132 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:50:59,132 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:50:59,132 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:50:59,134 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:50:59,134 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:50:59,135 transcriptomic_clustering.de_ebayes INFO     Comparing 10 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:00,084 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:00,085 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:00,085 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 0 -- de score: 0
2026-02-25 06:51:00,091 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 1 -- de score: 0
2026-02-25 06:51:00,097 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:00,098 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:00,102 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:00,102 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:00,102 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:00,104 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:00,104 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:00,105 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:00,416 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:00,417 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:00,417 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 1 -- de score: 0
2026-02-25 06:51:00,423 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:00,423 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:00,426 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:00,426 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:00,426 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:00,428 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:00,429 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:00,430 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:00,547 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:00,548 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:00,549 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:51:00,555 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:00,555 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 3.6280233524739742
2026-02-25 06:51:00,555 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:00,555 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:00,555 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:00,557 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:00,557 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:00,558 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:00,583 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:00,583 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.0281464122235775
2026-02-25 06:51:00,583 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:00,583 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 3.912472277879715
2026-02-25 06:51:00,583 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:51:00,776 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:51:00,776 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:51:00,777 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0007372908294200897
2026-02-25 06:51:00,777 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/644 [00:00<?, ?it/s]100%|██████████| 644/644 [00:00<00:00, 66404.40it/s]
  0%|          | 0/644 [00:00<?, ?it/s]100%|██████████| 644/644 [00:00<00:00, 1101603.50it/s]
2026-02-25 06:51:02,623 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 8 clusters
2026-02-25 06:51:02,623 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 1.8465943932533264
2026-02-25 06:51:02,623 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:51:02,623 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:51:02,625 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:51:02,625 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0019099637866020203
2026-02-25 06:51:02,625 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:51:02,625 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:51:02,625 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.6504119634628296e-05
2026-02-25 06:51:02,626 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:51:02,707 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:51:02,708 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.08199720829725266
2026-02-25 06:51:02,708 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:51:02,708 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:02,717 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:02,717 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:02,717 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:02,719 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:02,720 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:02,721 transcriptomic_clustering.de_ebayes INFO     Comparing 20 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:04,529 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:04,530 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:04,530 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 3 -- de score: 0
2026-02-25 06:51:04,536 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 2 -- de score: 0
2026-02-25 06:51:04,541 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 4 -- de score: 0
2026-02-25 06:51:04,547 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 32.656576264831344
2026-02-25 06:51:04,552 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:04,553 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:04,558 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:04,558 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:04,558 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:04,560 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:04,560 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:04,561 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:05,127 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:05,127 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:05,128 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 2 -- de score: 0
2026-02-25 06:51:05,134 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:51:05,139 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:05,140 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:05,143 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:05,143 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:05,144 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:05,145 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:05,145 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:05,147 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:05,261 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:05,261 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:05,262 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:51:05,269 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:05,269 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 2.56147688254714
2026-02-25 06:51:05,269 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:05,269 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:05,269 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:05,271 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:05,271 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:05,273 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:05,304 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:05,304 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.03453751653432846
2026-02-25 06:51:05,304 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:05,304 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 2.68066668137908
2026-02-25 06:51:05,304 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:51:05,514 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:51:05,514 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:51:05,516 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0010177046060562134
2026-02-25 06:51:05,516 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/325 [00:00<?, ?it/s]100%|██████████| 325/325 [00:00<00:00, 49434.23it/s]
  0%|          | 0/325 [00:00<?, ?it/s]100%|██████████| 325/325 [00:00<00:00, 20041.59it/s]
2026-02-25 06:51:07,953 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 6 clusters
2026-02-25 06:51:07,954 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 2.437906265258789
2026-02-25 06:51:07,954 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:51:07,954 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:51:07,955 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:51:07,955 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0016428008675575256
2026-02-25 06:51:07,955 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:51:07,955 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:51:07,955 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.773346543312073e-05
2026-02-25 06:51:07,955 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:51:08,002 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:51:08,002 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.04616452753543854
2026-02-25 06:51:08,002 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:51:08,002 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:08,009 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:08,009 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:08,009 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:08,012 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:08,012 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:08,014 transcriptomic_clustering.de_ebayes INFO     Comparing 14 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:09,357 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:09,357 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:09,358 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:51:09,363 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 0
2026-02-25 06:51:09,368 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 2 -- de score: 0
2026-02-25 06:51:09,374 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:09,374 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:09,379 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:09,379 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:09,379 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:09,381 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:09,381 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:09,383 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:09,662 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:09,662 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:09,662 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:51:09,668 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:09,668 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:09,671 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:09,671 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:09,671 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:09,673 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:09,673 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:09,674 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:09,783 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:09,784 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:09,784 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:51:09,792 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:09,793 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 1.7908006459474564
2026-02-25 06:51:09,793 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:09,793 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:09,793 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:09,795 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:09,796 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:09,797 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:10,305 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:10,306 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.5128445103764534
2026-02-25 06:51:10,306 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:10,306 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 2.352168247103691
2026-02-25 06:51:10,306 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:51:11,089 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:51:11,089 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:51:11,090 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0009221658110618591
2026-02-25 06:51:11,090 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/141 [00:00<?, ?it/s]100%|██████████| 141/141 [00:00<00:00, 35250.45it/s]
  0%|          | 0/141 [00:00<?, ?it/s]100%|██████████| 141/141 [00:00<00:00, 16177.83it/s]
2026-02-25 06:51:11,870 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 5 clusters
2026-02-25 06:51:11,870 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.7795022316277027
2026-02-25 06:51:11,870 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:51:11,870 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:51:11,871 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:51:11,871 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0015548691153526306
2026-02-25 06:51:11,871 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:51:11,872 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:51:11,872 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.760680556297302e-05
2026-02-25 06:51:11,872 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:51:11,897 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:51:11,897 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.02566055953502655
2026-02-25 06:51:11,897 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:51:11,897 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:11,905 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:11,905 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:11,905 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:11,908 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:11,908 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:11,909 transcriptomic_clustering.de_ebayes INFO     Comparing 10 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:12,887 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:12,887 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:12,888 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 2.425904925949123
2026-02-25 06:51:12,894 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 1 -- de score: 5.206643715916243
2026-02-25 06:51:12,900 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:12,900 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:12,904 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:12,904 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:12,904 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:12,906 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:12,906 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:12,908 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:13,179 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:13,179 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:13,180 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 11.321805351452054
2026-02-25 06:51:13,185 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:13,185 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:13,188 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:13,188 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:13,188 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:13,190 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:13,190 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:13,192 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:13,299 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:13,300 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:13,300 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 6.652871023323713
2026-02-25 06:51:13,309 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:13,309 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 1.411301076412201
2026-02-25 06:51:13,309 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:13,309 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:13,309 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:13,312 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:13,312 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:13,314 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:13,337 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:13,337 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.028473716229200363
2026-02-25 06:51:13,338 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:13,338 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 1.4677458219230175
2026-02-25 06:51:13,338 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:51:13,438 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:51:13,438 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:51:13,438 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0008109807968139648
2026-02-25 06:51:13,439 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/109 [00:00<?, ?it/s]100%|██████████| 109/109 [00:00<00:00, 20442.64it/s]
  0%|          | 0/109 [00:00<?, ?it/s]100%|██████████| 109/109 [00:00<00:00, 14146.27it/s]
2026-02-25 06:51:14,037 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 5 clusters
2026-02-25 06:51:14,037 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.5981548316776752
2026-02-25 06:51:14,037 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:51:14,037 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:51:14,038 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:51:14,038 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0015698112547397614
2026-02-25 06:51:14,038 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:51:14,039 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:51:14,039 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.724545240402222e-05
2026-02-25 06:51:14,039 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:51:14,057 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:51:14,057 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.018573064357042313
2026-02-25 06:51:14,057 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:51:14,057 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:14,065 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:14,065 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:14,065 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:14,067 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:14,068 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:14,069 transcriptomic_clustering.de_ebayes INFO     Comparing 10 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:15,034 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:15,035 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:15,035 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 2 -- de score: 0
2026-02-25 06:51:15,041 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 1.6773325698110022
2026-02-25 06:51:15,047 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:15,047 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:15,051 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:15,051 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:15,051 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:15,053 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:15,053 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:15,055 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:15,337 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:15,337 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:15,337 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 2 -- de score: 0
2026-02-25 06:51:15,343 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:15,343 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:15,347 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:15,347 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:15,347 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:15,349 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:15,349 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:15,350 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:15,467 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:15,468 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:15,468 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:51:15,474 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:15,474 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 1.4171767719089985
2026-02-25 06:51:15,475 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:15,475 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:15,475 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:15,477 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:15,477 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:15,478 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:15,510 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:15,511 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.03605298325419426
2026-02-25 06:51:15,511 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:15,511 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 1.474057961255312
2026-02-25 06:51:15,511 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:51:16,256 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:51:16,257 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:51:16,258 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0008386671543121338
2026-02-25 06:51:16,258 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/4430 [00:00<?, ?it/s]100%|██████████| 4430/4430 [00:00<00:00, 47836.18it/s]
  0%|          | 0/4430 [00:00<?, ?it/s] 50%|████▉     | 2206/4430 [00:00<00:00, 21037.13it/s]100%|██████████| 4430/4430 [00:00<00:00, 23999.21it/s]
2026-02-25 06:51:22,186 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 12 clusters
2026-02-25 06:51:22,186 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 5.928367476910353
2026-02-25 06:51:22,186 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:51:22,186 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:51:22,190 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:51:22,190 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0038001909852027893
2026-02-25 06:51:22,190 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:51:22,190 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:51:22,190 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.4771859645843506e-05
2026-02-25 06:51:22,190 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:51:23,415 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:51:23,415 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 1.2247226238250732
2026-02-25 06:51:23,415 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:51:23,415 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:23,432 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:23,432 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:23,432 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:23,435 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:23,436 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:23,437 transcriptomic_clustering.de_ebayes INFO     Comparing 27 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:25,931 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:25,932 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:25,932 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 0
2026-02-25 06:51:25,938 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:51:25,944 transcriptomic_clustering.merging DEBUG    Merging cluster 8 into 6 -- de score: 0
2026-02-25 06:51:25,949 transcriptomic_clustering.merging DEBUG    Merging cluster 9 into 1 -- de score: 0
2026-02-25 06:51:25,955 transcriptomic_clustering.merging DEBUG    Merging cluster 10 into 5 -- de score: 0
2026-02-25 06:51:25,961 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:25,967 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:25,968 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:25,968 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:25,969 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:25,969 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:25,971 transcriptomic_clustering.de_ebayes INFO     Comparing 13 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:27,167 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:27,168 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:27,168 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:51:27,174 transcriptomic_clustering.merging DEBUG    Merging cluster 11 into 5 -- de score: 0
2026-02-25 06:51:27,181 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 6 -- de score: 0
2026-02-25 06:51:27,187 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:27,187 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:27,193 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:27,193 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:27,193 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:27,195 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:27,195 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:27,196 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:27,749 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:27,749 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:27,750 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:51:27,755 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 5 -- de score: 0
2026-02-25 06:51:27,760 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:27,760 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:27,764 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:27,764 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:27,764 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:27,766 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:27,766 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:27,767 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:27,874 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:27,875 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:27,875 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 0 -- de score: 0
2026-02-25 06:51:27,883 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:27,883 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 4.468252994120121
2026-02-25 06:51:27,884 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:27,884 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:27,884 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:27,887 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:27,887 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:27,888 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:27,907 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:27,907 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.023772113025188446
2026-02-25 06:51:27,908 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:27,908 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 5.721510026603937
2026-02-25 06:51:27,908 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
sion this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:01,333 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:01,333 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:01,334 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 0 -- de score: 0
2026-02-25 06:51:01,340 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:01,340 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 4.4623854495584965
2026-02-25 06:51:01,340 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:01,340 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:01,341 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:01,342 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:01,343 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:01,344 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:02,550 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:02,550 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 1.2097069397568703
2026-02-25 06:51:02,550 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:02,550 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 5.967658419162035
2026-02-25 06:51:02,550 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:51:03,539 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:51:03,539 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:51:03,540 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.000857081264257431
2026-02-25 06:51:03,540 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/365 [00:00<?, ?it/s]100%|██████████| 365/365 [00:00<00:00, 64462.54it/s]
  0%|          | 0/365 [00:00<?, ?it/s]100%|██████████| 365/365 [00:00<00:00, 20801.12it/s]
2026-02-25 06:51:04,305 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 7 clusters
2026-02-25 06:51:04,305 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.7649309113621712
2026-02-25 06:51:04,305 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:51:04,305 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:51:04,307 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:51:04,307 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0018663033843040466
2026-02-25 06:51:04,307 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:51:04,307 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:51:04,307 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.791972994804382e-05
2026-02-25 06:51:04,307 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:51:04,366 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:51:04,366 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.058515533804893494
2026-02-25 06:51:04,366 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:51:04,366 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:04,375 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:04,375 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:04,375 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:04,378 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:04,378 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:04,380 transcriptomic_clustering.de_ebayes INFO     Comparing 17 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:05,994 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:05,995 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:05,995 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 0 -- de score: 0
2026-02-25 06:51:06,001 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 4 -- de score: 0
2026-02-25 06:51:06,007 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 1 -- de score: 0
2026-02-25 06:51:06,013 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:06,013 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:06,018 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:06,019 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:06,019 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:06,020 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:06,021 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:06,022 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:06,518 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:06,519 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:06,519 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 0 -- de score: 0
2026-02-25 06:51:06,525 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 8.583519056408253
2026-02-25 06:51:06,530 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:06,530 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:06,534 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:06,534 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:06,534 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:06,536 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:06,536 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:06,538 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:06,642 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:06,643 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:06,643 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:51:06,652 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:06,652 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 2.2863021939992905
2026-02-25 06:51:06,652 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:06,652 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:06,652 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:06,656 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:06,656 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:06,657 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:07,797 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:07,797 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 1.144605379551649
2026-02-25 06:51:07,797 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:07,797 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 3.4919950738549232
2026-02-25 06:51:07,797 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:51:07,927 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:51:07,927 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:51:07,929 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0018907450139522552
2026-02-25 06:51:07,929 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/70 [00:00<?, ?it/s]100%|██████████| 70/70 [00:00<00:00, 14980.42it/s]
  0%|          | 0/70 [00:00<?, ?it/s]100%|██████████| 70/70 [00:00<00:00, 322993.71it/s]
2026-02-25 06:51:08,806 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 4 clusters
2026-02-25 06:51:08,806 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.8764975592494011
2026-02-25 06:51:08,806 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:51:08,806 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:51:08,808 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:51:08,808 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.001499626785516739
2026-02-25 06:51:08,808 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:51:08,808 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:51:08,808 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 4.204362630844116e-05
2026-02-25 06:51:08,808 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:51:08,822 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:51:08,822 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.014338523149490356
2026-02-25 06:51:08,822 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:51:08,822 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:08,822 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:08,829 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:08,829 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:08,829 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:08,832 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:08,832 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:08,834 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:09,370 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:09,371 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:09,371 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:51:09,377 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 2 -- de score: 0
2026-02-25 06:51:09,382 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:09,382 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:09,386 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:09,386 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:09,386 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:09,387 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:09,388 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:09,389 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwalating de scores using ebayes
2026-02-25 06:51:01,525 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:01,527 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:01,527 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:01,529 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:01,645 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:01,645 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:01,646 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de s2026-02-25 06:51:09,527 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:09,527 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.024510912597179413
2026-02-25 06:51:09,527 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:09,527 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 0.7210157439112663
2026-02-25 06:51:09,527 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:51:10,390 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:51:10,390 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:51:10,391 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0009714588522911072
2026-02-25 06:51:10,391 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/2152 [00:00<?, ?it/s]100%|██████████| 2152/2152 [00:00<00:00, 59189.37it/s]
  0%|          | 0/2152 [00:00<?, ?it/s]100%|██████████| 2152/2152 [00:00<00:00, 1452315.72it/s]
2026-02-25 06:51:13,108 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 12 clusters
2026-02-25 06:51:13,108 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 2.717635840177536
2026-02-25 06:51:13,109 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:51:13,109 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:51:13,112 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:51:13,112 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0033134445548057556
2026-02-25 06:51:13,112 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:51:13,112 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:51:13,112 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.9130449295043945e-05
2026-02-25 06:51:13,112 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:51:13,577 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:51:13,578 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.46532268822193146
2026-02-25 06:51:13,578 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:51:13,578 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:13,591 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:13,591 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:13,591 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:13,594 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:13,594 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:13,595 transcriptomic_clustering.de_ebayes INFO     Comparing 30 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:16,345 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:16,346 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:16,346 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 2 -- de score: 0
2026-02-25 06:51:16,353 transcriptomic_clustering.merging DEBUG    Merging cluster 11 into 10 -- de score: 0
2026-02-25 06:51:16,359 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 0 -- de score: 0
2026-02-25 06:51:16,365 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 3 -- de score: 0
2026-02-25 06:51:16,372 transcriptomic_clustering.merging DEBUG    Merging cluster 9 into 4 -- de score: 36.67419708947957
2026-02-25 06:51:16,379 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:16,386 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:16,386 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:16,386 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:16,388 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:16,388 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:16,390 transcriptomic_clustering.de_ebayes INFO     Comparing 14 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:17,756 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:17,757 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:17,757 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 2 -- de score: 0
2026-02-25 06:51:17,764 transcriptomic_clustering.merging DEBUG    Merging cluster 10 into 0 -- de score: 0
2026-02-25 06:51:17,770 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 1 -- de score: 0
2026-02-25 06:51:17,776 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:17,776 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:17,782 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:17,782 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:17,782 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:17,784 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:17,784 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:17,785 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:18,353 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:18,354 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:18,354 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 0
2026-02-25 06:51:18,360 transcriptomic_clustering.merging DEBUG    Merging cluster 8 into 0 -- de score: 59.52102050812607
2026-02-25 06:51:18,365 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:18,366 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:18,369 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:18,369 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:18,369 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:18,371 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:18,371 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:18,373 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:18,478 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:18,478 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:18,479 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:51:18,487 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:18,487 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 4.909468460828066
2026-02-25 06:51:18,487 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:18,487 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:18,487 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:18,491 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:18,491 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:18,492 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:18,512 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:18,512 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.025098081678152084
2026-02-25 06:51:18,513 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:18,513 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 5.404078185558319
2026-02-25 06:51:18,513 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:51:18,823 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:51:18,823 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:51:18,824 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0007910169661045074
2026-02-25 06:51:18,824 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/561 [00:00<?, ?it/s]100%|██████████| 561/561 [00:00<00:00, 58966.63it/s]
  0%|          | 0/561 [00:00<?, ?it/s]100%|██████████| 561/561 [00:00<00:00, 22150.09it/s]
2026-02-25 06:51:19,690 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 10 clusters
2026-02-25 06:51:19,690 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.8659272566437721
2026-02-25 06:51:19,690 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:51:19,690 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:51:19,693 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:51:19,693 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0024630725383758545
2026-02-25 06:51:19,693 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:51:19,693 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:51:19,693 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.8057565689086914e-05
2026-02-25 06:51:19,693 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:51:19,782 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:51:19,782 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.08902712911367416
2026-02-25 06:51:19,782 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:51:19,782 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:19,793 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:19,793 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:19,793 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:19,796 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:19,796 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:19,798 transcriptomic_clustering.de_ebayes INFO     Comparing 26 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:22,152 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:22,153 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:22,153 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 0 -- de score: 7.6722261279818635
2026-02-25 06:51:22,160 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 1 -- de score: 8.822538521591568
2026-02-25 06:51:22,167 transcriptomic_clustering.merging DEBUG    Merging cluster 8 into 7 -- de score: 60.980584549555175
2026-02-25 06:51:22,173 transcriptomic_clustering.merging DEBUG    Merging cluster 9 into 5 -- de score: 64.16822910826565
2026-02-25 06:51:22,179 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 2 -- de score: 79.54185226815177
2026-02-25 06:51:22,185 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:22,192 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:22,192 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:22,192 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:22,194 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:22,194 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:22,196 transcriptomic_clustering.de_ebayes INFO     Comparing 10 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:23,147 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:23,147 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:23,148 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 1 -- de score: 0
2026-02-25 06:51:23,153 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 0 -- de score: 14.983769010698813
2026-02-25 06:51:23,159 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:23,159 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:23,163 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:23,163 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:23,164 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:23,165 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:23,166 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:23,167 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:23,503 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:23,504 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:23,504 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 1 -- de score: 8.000637648253212
2026-02-25 06:51:23,510 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:23,510 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:23,514 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:23,514 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:23,514 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:23,516 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:23,516 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:23,517 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:23,637 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:23,638 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:23,638 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 40.692880454187566
2026-02-25 06:51:23,644 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:23,644 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 3.8617941103875637
2026-02-25 06:51:23,644 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:23,644 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:23,644 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:23,646 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:23,646 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:23,647 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:23,673 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:23,674 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.02982766181230545
2026-02-25 06:51:23,674 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:23,674 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 3.9838051199913025
2026-02-25 06:51:23,674 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:51:23,987 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:51:23,987 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:51:23,988 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0009816810488700867
2026-02-25 06:51:23,988 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/1063 [00:00<?, ?it/s]100%|██████████| 1063/1063 [00:00<00:00, 72309.72it/s]
  0%|          | 0/1063 [00:00<?, ?it/s]100%|██████████| 1063/1063 [00:00<00:00, 33890.60it/s]
2026-02-25 06:51:25,261 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 9 clusters
2026-02-25 06:51:25,261 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 1.2729953490197659
2026-02-25 06:51:25,261 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:51:25,261 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:51:25,264 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:51:25,264 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.002518095076084137
2026-02-25 06:51:25,264 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:51:25,264 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:51:25,264 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.8955360651016235e-05
2026-02-25 06:51:25,264 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:51:25,473 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:51:25,473 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.20871379598975182
2026-02-25 06:51:25,473 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:51:25,473 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:25,484 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:25,484 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:25,484 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:25,487 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:25,487 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:25,489 transcriptomic_clustering.de_ebayes INFO     Comparing 24 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:27,751 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:27,752 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:27,752 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 0
2026-02-25 06:51:27,758 transcriptomic_clustering.merging DEBUG    Merging cluster 6 into 0 -- de score: 0
2026-02-25 06:51:27,764 transcriptomic_clustering.merging DEBUG    Merging cluster 8 into 1 -- de score: 0
2026-02-25 06:51:27,770 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:27,776 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:27,776 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:27,776 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:27,778 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:27,778 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:27,779 transcriptomic_clustering.de_ebayes INFO     Comparing 9 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:28,570 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:28,570 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:28,571 transcriptomic_clustering.merging DEBUG    Merging cluster 7 into 0 -- de score: 0
2026-02-25 06:51:28,577 transcriptomic_clustering.merging DEBUG    Merging cluster 5 into 3 -- de score: 0
2026-02-25 06:51:28,583 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:28,584 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:28,588 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:28,588 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:28,588 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:28,590 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:28,590 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:28,592 transcriptomic_clustering.de_ebayes INFO     Comparing 5 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:29,101 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:29,102 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:29,102 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:51:29,108 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 2 -- de score: 66.27423380170937
2026-02-25 06:51:29,113 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:29,114 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:29,117 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:29,117 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:29,118 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:29,119 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:29,120 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:29,121 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:29,238 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:29,239 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:29,239 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:51:29,246 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:29,246 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 3.772788841277361
2026-02-25 06:51:29,246 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:29,246 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:29,246 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:29,248 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:29,248 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:29,249 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:29,276 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:29,276 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.03002201020717621
2026-02-25 06:51:29,276 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:29,276 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 4.014745656400919
2026-02-25 06:51:29,276 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
alar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:22,720 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:22,720 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:22,720 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:51:22,726 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 2 -- de score: 0
2026-02-25 06:51:22,732 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:22,732 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:22,736 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:22,736 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:22,736 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:22,738 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:22,738 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:22,740 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:23,020 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:23,021 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:23,021 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 2 -- de score: 0
2026-02-25 06:51:23,027 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:23,027 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:23,030 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:23,030 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:23,030 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:23,032 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:23,032 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:23,034 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:23,136 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:23,137 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:23,137 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:51:23,145 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:23,145 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 1.3602719493210316
2026-02-25 06:51:23,145 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:23,145 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:23,145 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:23,149 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:23,149 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:23,150 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:23,173 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:23,173 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.027514860033988953
2026-02-25 06:51:23,173 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:23,173 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 1.4100760519504547
2026-02-25 06:51:23,173 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:51:23,273 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:51:23,273 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:51:23,274 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0006617791950702667
2026-02-25 06:51:23,274 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/33 [00:00<?, ?it/s]100%|██████████| 33/33 [00:00<00:00, 9816.46it/s]
  0%|          | 0/33 [00:00<?, ?it/s]100%|██████████| 33/33 [00:00<00:00, 7033.13it/s]
2026-02-25 06:51:23,640 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 5 clusters
2026-02-25 06:51:23,640 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.3656556159257889
2026-02-25 06:51:23,640 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:51:23,640 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:51:23,641 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:51:23,641 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0013801716268062592
2026-02-25 06:51:23,641 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:51:23,647 transcriptomic_clustering.merging DEBUG    Merging small cluster 4 into 0 -- similarity: 0.9522884522604139
2026-02-25 06:51:23,652 transcriptomic_clustering.merging DEBUG    Merging small cluster 1 into 0 -- similarity: 0.9387023335736976
2026-02-25 06:51:23,657 transcriptomic_clustering.merging DEBUG    Merging small cluster 3 into 0 -- similarity: 0.9332404919640923
2026-02-25 06:51:23,661 transcriptomic_clustering.merging DEBUG    Merging small cluster 2 into 0 -- similarity: 0.8760984548796247
2026-02-25 06:51:23,662 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:51:23,662 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 0.020953044295310974
2026-02-25 06:51:23,662 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:51:23,672 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:51:23,672 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.009575992822647095
2026-02-25 06:51:23,672 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:51:23,672 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:23,672 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 6.646662950515747e-05
2026-02-25 06:51:23,672 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:23,672 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:23,672 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:23,675 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:23,675 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:23,677 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:23,696 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:23,696 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.023763976991176605
2026-02-25 06:51:23,696 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:23,696 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 0.05636356770992279
2026-02-25 06:51:23,696 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
2026-02-25 06:51:23,828 transcriptomic_clustering.onestep_clustering INFO     Starting onestep clustering
2026-02-25 06:51:23,828 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims
2026-02-25 06:51:23,829 transcriptomic_clustering.onestep_clustering INFO     Extracting latent dims Elapsed Time: 0.0008724108338356018
2026-02-25 06:51:23,829 transcriptomic_clustering.onestep_clustering INFO     Starting Louvain Clustering
  0%|          | 0/135 [00:00<?, ?it/s]100%|██████████| 135/135 [00:00<00:00, 27635.86it/s]
  0%|          | 0/135 [00:00<?, ?it/s]100%|██████████| 135/135 [00:00<00:00, 17039.24it/s]
2026-02-25 06:51:24,325 transcriptomic_clustering.onestep_clustering INFO     Completed Louvain Clustering, found 5 clusters
2026-02-25 06:51:24,325 transcriptomic_clustering.onestep_clustering INFO     Clustering Elapsed Time: 0.49638186767697334
2026-02-25 06:51:24,325 transcriptomic_clustering.onestep_clustering INFO     Starting Cluster Merging
2026-02-25 06:51:24,325 transcriptomic_clustering.merging INFO     Computing reduced cluster means
2026-02-25 06:51:24,327 transcriptomic_clustering.merging INFO     Completed reduced cluster means
2026-02-25 06:51:24,327 transcriptomic_clustering.merging INFO     Reduced Cluster Means Elapsed Time: 0.0014305487275123596
2026-02-25 06:51:24,327 transcriptomic_clustering.merging INFO     Merging small clusters
2026-02-25 06:51:24,327 transcriptomic_clustering.merging INFO     Completed merging small clusters
2026-02-25 06:51:24,327 transcriptomic_clustering.merging INFO     Small Clusters Elapsed Time: 3.592297434806824e-05
2026-02-25 06:51:24,327 transcriptomic_clustering.merging INFO     Computing Cluster Means
2026-02-25 06:51:24,354 transcriptomic_clustering.merging INFO     Completed Cluster Means
2026-02-25 06:51:24,354 transcriptomic_clustering.merging INFO     Cluster Means Elapsed Time: 0.02687428891658783
2026-02-25 06:51:24,354 transcriptomic_clustering.merging INFO     Merging Clusters by DE
2026-02-25 06:51:24,354 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:24,361 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:24,361 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:24,361 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:24,364 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:24,364 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:24,366 transcriptomic_clustering.de_ebayes INFO     Comparing 10 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:25,522 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:25,523 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:25,523 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:51:25,529 transcriptomic_clustering.merging DEBUG    Merging cluster 4 into 3 -- de score: 0
2026-02-25 06:51:25,535 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:25,535 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:25,539 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:25,539 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:25,539 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:25,541 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:25,541 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:25,542 transcriptomic_clustering.de_ebayes INFO     Comparing 3 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:25,837 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:25,837 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:25,837 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:51:25,843 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:25,843 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:25,846 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:25,846 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:25,847 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:25,848 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:25,849 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:25,850 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:25,966 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:25,967 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:25,967 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 0 -- de score: 0
2026-02-25 06:51:25,974 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:25,974 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 1.6201015263795853
2026-02-25 06:51:25,974 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:25,974 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:25,974 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:25,976 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:25,976 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:25,978 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:25,999 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:26,000 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.025457631796598434
2026-02-25 06:51:26,000 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:26,000 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 1.6745018027722836
2026-02-25 06:51:26,000 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:24,266 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:24,266 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:24,266 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:24,269 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:24,269 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:24,270 transcriptomic_clustering.de_ebayes INFO     Comparing 6 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:24,787 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:24,788 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:24,788 transcriptomic_clustering.merging DEBUG    Merging cluster 1 into 0 -- de score: 0
2026-02-25 06:51:24,793 transcriptomic_clustering.merging DEBUG    Merging cluster 3 into 2 -- de score: 0
2026-02-25 06:51:24,799 transcriptomic_clustering.merging INFO     Getting 4 nearest clusters
2026-02-25 06:51:24,799 transcriptomic_clustering.merging DEBUG    k cannot be greater than or the same as the number of clusters. Defaulting to number of clusters - 1.
2026-02-25 06:51:24,803 transcriptomic_clustering.merging INFO     Completed 4 nearest clusters
2026-02-25 06:51:24,803 transcriptomic_clustering.merging INFO     Calculating de scores using ebayes
2026-02-25 06:51:24,803 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:24,805 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:24,805 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:24,806 transcriptomic_clustering.de_ebayes INFO     Comparing 1 pairs
/allen/programs/celltypes/workgroups/rnaseqanalysis/dyuan/miniconda3/envs/tc/lib/python3.10/site-packages/numpy/core/fromnumeric.py:84: FutureWarning: The behavior of DataFrame.sum with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return reduction(axis=axis, out=out, **passkwargs)
2026-02-25 06:51:24,917 transcriptomic_clustering.merging INFO     Sorting DE Scores
2026-02-25 06:51:24,917 transcriptomic_clustering.merging INFO     Merging clusters by DE score
2026-02-25 06:51:24,918 transcriptomic_clustering.merging DEBUG    Merging cluster 2 into 0 -- de score: 0
2026-02-25 06:51:24,926 transcriptomic_clustering.merging INFO     Completed Merging Clusters by DE
2026-02-25 06:51:24,926 transcriptomic_clustering.merging INFO     Merging DE Elapsed Time: 0.6656924746930599
2026-02-25 06:51:24,926 transcriptomic_clustering.merging INFO     Starting Marker Selection
2026-02-25 06:51:24,926 transcriptomic_clustering.markers DEBUG    Generating markers for 0.0 pairs of clusters
2026-02-25 06:51:24,926 transcriptomic_clustering.de_ebayes INFO     Fitting Variances
2026-02-25 06:51:24,929 transcriptomic_clustering.de_ebayes INFO     Moderating Variances
2026-02-25 06:51:24,930 transcriptomic_clustering.de_ebayes DEBUG    offsetting zero variances from zero
2026-02-25 06:51:24,931 transcriptomic_clustering.de_ebayes INFO     Comparing 0 pairs
2026-02-25 06:51:25,223 transcriptomic_clustering.merging INFO     Completed Marker Selection
2026-02-25 06:51:25,223 transcriptomic_clustering.merging INFO     Marker Selection Elapsed Time: 0.2968083769083023
2026-02-25 06:51:25,223 transcriptomic_clustering.onestep_clustering INFO     Completed Cluster Merging
2026-02-25 06:51:25,223 transcriptomic_clustering.onestep_clustering INFO     Merging Elapsed Time: 0.977073397487402
2026-02-25 06:51:25,223 transcriptomic_clustering.onestep_clustering INFO     Completed One Step Clustering
